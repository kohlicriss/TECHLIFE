/*! For license information please see 708.b757445c.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunktechlife=self.webpackChunktechlife||[]).push([[708],{5244:(e,t,r)=>{r.d(t,{A:()=>s});const s=(0,r(7784).A)("ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]])},5708:(e,t,r)=>{r.r(t),r.d(t,{default:()=>m});var s=r(5043),o=r(5244);const a=(0,r(7784).A)("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);var l=r(6833),i=r(7719),n=r(184),c=r(6446),d=r(3721),u=r(9910),g=r(579);function h(e){let{onSubmit:t}=e;const{theme:r}=(0,s.useContext)(u.ob),o="dark"===r,[a,l]=(0,s.useState)([]),[i,n]=(0,s.useState)({employeeId:"",ticketId:"",title:"",priority:"Low",description:"",roles:""}),[c,d]=(0,s.useState)(!1);(0,s.useEffect)(()=>{const e=localStorage.getItem("employeeId");if(e){const t=JSON.parse(e);n(e=>({...e,employeeId:t.employeeId||""}))}},[]);const h=e=>n(t=>({...t,[e.target.name]:e.target.value}));return(0,g.jsxs)("div",{className:"relative",children:[(0,g.jsxs)("form",{onSubmit:e=>{e.preventDefault(),console.log("Form Submitted:",i),d(!0),setTimeout(()=>d(!1),3e3),t(i),n(e=>({...e,ticketId:"",title:"",priority:"Low",description:"",roles:""}))},className:"p-8 rounded-2xl shadow-lg space-y-6 border transition "+(o?"bg-gray-900 border-gray-700 text-white":"bg-white border-gray-500 text-black"),children:[(0,g.jsx)("h2",{className:"text-3xl font-bold text-center "+(o?"text-blue-300":"text-blue-700"),children:"Fill the form"}),(0,g.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-1 gap-4",children:(0,g.jsx)("input",{name:"title",placeholder:"Issue Title",value:i.title,onChange:h,required:!0,className:"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 "+(o?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300 text-black")})}),(0,g.jsxs)("select",{name:"priority",value:i.priority,onChange:h,required:!0,className:"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 "+(o?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300 text-black"),children:[(0,g.jsx)("option",{value:"Low",children:"Low"}),(0,g.jsx)("option",{value:"Medium",children:"Medium"}),(0,g.jsx)("option",{value:"High",children:"High"})]}),(0,g.jsxs)("select",{name:"roles",value:i.roles,onChange:h,required:!0,className:"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 "+(o?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300 text-black"),children:[(0,g.jsx)("option",{value:"",children:"Select Role"}),(0,g.jsx)("option",{value:"ROLE_ADMIN",children:"Admin"}),(0,g.jsx)("option",{value:"ROLE_HR",children:"HR"}),(0,g.jsx)("option",{value:"ROLE_MANAGER",children:"Manager"})]}),(0,g.jsx)("textarea",{name:"description",placeholder:"Describe your issue in detail",value:i.description,onChange:h,required:!0,rows:"5",className:"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 "+(o?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300 text-black")}),(0,g.jsx)("div",{className:"flex justify-center",children:(0,g.jsx)("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg shadow-md transition",children:"Submit Ticket"})})]}),c&&(0,g.jsx)("div",{className:"absolute top-4 right-4 z-50 bg-green-500 text-white px-5 py-3 rounded-lg shadow-md",children:"\u2705 Ticket submitted successfully!"})]})}function x(e){let{userRole:t="employee",ticketId:r,ticketStatus:o}=e;const[a,l]=(0,s.useState)([]),[i,n]=(0,s.useState)(""),c=(0,s.useRef)(null),d=(0,s.useRef)(null),h=(0,s.useRef)(null),x=(0,s.useRef)(null),[b,y]=(0,s.useState)(0),[m,p]=(0,s.useState)(!0),[f,w]=(0,s.useState)(!1),{userData:v,theme:j}=(0,s.useContext)(u.ob),k=(null===v||void 0===v?void 0:v.permissions)||[],N="resolved"===(null===o||void 0===o?void 0:o.toLowerCase()),S=e=>{const t=new Map;return e.forEach(e=>{const r=e.id?String(e.id):`${e.repliedAt}-${e.replyText}`;t.set(r,e)}),Array.from(t.values()).sort((e,t)=>new Date(e.repliedAt)-new Date(t.repliedAt))},A="dark"===j,T=a.reduce((e,t)=>{const r=(e=>{const t=new Date(e),r=new Date,s=new Date;return s.setDate(r.getDate()-1),t.toDateString()===r.toDateString()?"Today":t.toDateString()===s.toDateString()?"Yesterday":t.toLocaleDateString([],{day:"numeric",month:"short",year:"numeric"})})(t.repliedAt);return e[r]||(e[r]=[]),e[r].push(t),e},{}),E=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=localStorage.getItem("accessToken");if(r&&t&&!f&&m)try{w(!0);const s=await fetch(`https://hrms.anasolconsultancyservices.com/api/ticket/employee/tickets/${r}/messages?page=${e}&size=20`,{headers:{Authorization:`Bearer ${t}`}});if(403===s.status)return console.error(" Forbidden: VIEW_TICKET_REPLIES missing on backend"),l([]),void p(!1);if(!s.ok)throw new Error(`HTTP Error: ${s.status}`);const o=await s.json(),a=Array.isArray(null===o||void 0===o?void 0:o.content)?o.content:[];0===a.length?p(!1):(l(e=>S([...e,...a])),y(e+1))}catch(s){console.error(" Error fetching messages:",s)}finally{w(!1)}},D=e=>{if(!e)return"";return new Date(e.endsWith("Z")?e:e+"Z").toLocaleTimeString("en-IN",{timeZone:"Asia/Kolkata",hour:"2-digit",minute:"2-digit",hour12:!0})},C=()=>{if(!r)return void console.error("\u274c Missing ticketId, cannot open WebSocket");const e=localStorage.getItem("accessToken"),t=new WebSocket(`wss://hrms.anasolconsultancyservices.com/api/ticket/ws?ticketId=${r}?token=${e}`);t.onopen=()=>console.log("\u2705 WebSocket connected"),t.onmessage=e=>{try{const t=JSON.parse(e.data);console.log("\ud83d\udce9 Incoming WS message:",t),t&&t.replyText&&l(e=>S([...e,t]))}catch(t){console.error("\u274c WS parse error:",t,e.data)}},t.onclose=()=>{console.warn("WebSocket closed, reconnecting in 5s..."),setTimeout(C,5e3)},t.onerror=e=>console.error("\u274c WebSocket error:",e),c.current=t},I=async()=>{if(!i.trim()||N)return;const e=localStorage.getItem("accessToken"),s={ticketId:r,replyText:i,repliedBy:t,repliedAt:(new Date).toISOString()};try{await fetch(`https://hrms.anasolconsultancyservices.com/api/ticket/employee/tickets/${r}/messages`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(s)}),l(e=>S([...e,s]))}catch(o){console.error("\u274c Send failed:",o)}finally{n("")}};(0,s.useEffect)(()=>{const e=x.current;if(!e)return;var t;e.scrollHeight-e.scrollTop-e.clientHeight<100&&(null===(t=d.current)||void 0===t||t.scrollIntoView({behavior:"smooth"}))},[a]),(0,s.useEffect)(()=>{var e;null===(e=d.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[a]),(0,s.useEffect)(()=>(y(0),l([]),p(!0),E(0),C(),()=>{c.current&&c.current.close(),clearTimeout(h.current)}),[r]),(0,s.useEffect)(()=>{const e=x.current;if(!e)return;const t=()=>{if(0===e.scrollTop&&m&&!f){const e=b+1;y(e),E(e)}};return e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)},[b,m,f]);const L=(0,s.useRef)(0);return(0,s.useEffect)(()=>{const e=x.current;if(e)if(f)L.current=e.scrollHeight;else{const t=e.scrollHeight-L.current;t>0&&(e.scrollTop=t)}},[a,f]),(0,g.jsxs)("div",{className:"flex flex-col h-[500px] rounded-xl border shadow transition-colors duration-300 "+(A?"bg-gray-900 border-gray-700 text-white":"bg-white border-gray-200 text-black"),children:[(0,g.jsxs)("div",{ref:x,className:"flex-1 overflow-y-auto p-4 space-y-4 transition-colors duration-300 "+(A?"bg-gray-800":"bg-gray-50"),children:[Object.entries(T).map(e=>{let[r,s]=e;return(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:"text-center text-xs my-2 "+(A?"text-gray-400":"text-gray-500"),children:r}),s.map((e,r)=>(0,g.jsx)("div",{className:`flex ${e.repliedBy===t?"justify-end":"justify-start"} mb-2`,children:(0,g.jsxs)("div",{className:"px-4 py-2 rounded-lg shadow text-sm break-words "+(e.repliedBy===t?"bg-blue-600 text-white rounded-br-none":A?"bg-gray-700 text-white rounded-bl-none":"bg-gray-200 text-gray-900 rounded-bl-none"),style:{maxWidth:"80%",width:"fit-content"},children:[(0,g.jsx)("p",{className:"whitespace-pre-wrap",children:e.replyText}),(0,g.jsx)("div",{className:"text-right text-xs mt-1 opacity-60",children:e.repliedAt||e.clientTime?D(e.repliedAt||e.clientTime):""})]})},`${e.id||e.repliedAt}-${r}`))]},r)}),(0,g.jsx)("div",{ref:d})]}),(0,g.jsxs)("div",{className:"flex items-center gap-2 p-2 border-t "+(A?"border-gray-700":"border-gray-200"),children:[(0,g.jsx)("input",{type:"text",value:i,onChange:e=>n(e.target.value),onKeyDown:e=>"Enter"===e.key&&I(),placeholder:N?"This ticket is resolved. You cannot send messages.":"Type your message",disabled:N,className:"flex-1 border rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 transition-colors duration-300 "+(N?"bg-gray-200 cursor-not-allowed text-red-500":A?"bg-gray-800 border-gray-600 text-white placeholder-gray-400 focus:ring-blue-400":"bg-white border-gray-300 text-black placeholder-gray-500 focus:ring-blue-400")}),(0,g.jsx)("button",{onClick:I,disabled:N||!(null!==k&&void 0!==k&&k.includes("SEND_TICKET_REPLIES")),className:"px-4 py-2 rounded text-white transition "+(N?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"),children:"Send"})]})]})}function b(e){let{tickets:t,onTicketClick:r,lastTicketRef:o}=e;const{theme:a}=(0,s.useContext)(u.ob),l="dark"===a,i=e=>{if(!e)return"N/A";return new Date(e.endsWith("Z")?e:e+"Z").toLocaleString("en-IN",{timeZone:"Asia/Kolkata",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})};return t&&0!==t.length?(0,g.jsx)("div",{className:"space-y-4",children:t.map((e,s)=>{const a=s===t.length-1;return(0,g.jsxs)("div",{ref:a?o:null,onClick:()=>r(e),className:"cursor-pointer border rounded-lg p-4 shadow-md hover:shadow-lg transition-all "+(l?"bg-gray-800 border-gray-700 hover:border-blue-400 text-gray-200":"bg-white border-gray-300 hover:border-blue-400 text-gray-900"),children:[(0,g.jsxs)("h3",{className:"text-lg font-semibold mb-2 "+(l?"text-blue-300":"text-blue-700"),children:["Ticket ID: ",e.ticketId]}),(0,g.jsxs)("p",{children:[(0,g.jsx)("strong",{children:"Employee ID:"})," ",e.employeeId]}),(0,g.jsxs)("p",{children:[(0,g.jsx)("strong",{children:"Title:"})," ",e.title]}),(0,g.jsxs)("p",{children:[(0,g.jsx)("strong",{children:"Submitted:"})," ",i(e.createdAt||e.sentAt)]}),(0,g.jsxs)("p",{children:[(0,g.jsx)("strong",{children:"Status:"})," ",e.status]}),(0,g.jsxs)("p",{children:[(0,g.jsx)("strong",{children:"Description:"})," ",e.description]}),(0,g.jsxs)("p",{children:[(0,g.jsx)("strong",{children:"Assigned to:"})," ",e.roles]})]},e.ticketId)})}):(0,g.jsx)("div",{className:"text-center py-6 "+(l?"text-gray-400":"text-gray-500"),children:"No tickets submitted yet."})}var y=r(6213);function m(){const[e,t]=(0,s.useState)("history"),[r,m]=(0,s.useState)([]),[p,f]=(0,s.useState)(null),[w,v]=(0,s.useState)("All"),[j,k]=(0,s.useState)(""),[N,S]=(0,s.useState)(""),[A,T]=(0,s.useState)(""),[E,D]=(0,s.useState)("all"),[C,I]=(0,s.useState)(!1),[L,R]=(0,s.useState)(!1),[$,O]=(0,s.useState)("My Tickets"),[z,M]=(0,s.useState)(!1),H=(0,s.useRef)(0),[_,W]=(0,s.useState)(0),[P,F]=(0,s.useState)(!0),[B,Z]=(0,s.useState)(!1),[K,V]=(0,s.useState)(0),[q,Y]=(0,s.useState)([]),U=(0,d.Zp)(),{empID:J}=(0,d.g)(),{userData:G,theme:Q}=(0,s.useContext)(u.ob),X=(Array.isArray(null===G||void 0===G?void 0:G.roles)?G.roles[0]:(null===G||void 0===G?void 0:G.roles)||"").toUpperCase(),ee=localStorage.getItem("accessToken"),te="dark"===Q,re=[...null!==q&&void 0!==q&&q.includes("VIEW_MY_TICKETS")?[{tab:"My Tickets",icon:o.A}]:[],...null!==q&&void 0!==q&&q.includes("VIEW_ASSIGNED")&&"ROLE_EMPLOYEE"!==X?[{tab:"Assigned Tickets",icon:o.A}]:[]],se={all:"All",resolved:"Resolved"},oe={all:(0,g.jsx)(a,{size:20}),resolved:(0,g.jsx)(l.A,{size:20})},ae=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(ee&&J&&G&&!B&&P){Z(!0);try{const t=`https://hrms.anasolconsultancyservices.com/api/ticket/admin/tickets/employee/${J}?page=${e}&size=10&sort=createdAt,desc`,r=await y.A.get(t,{headers:{Authorization:`Bearer ${ee}`}}),{content:s,totalElements:o}=r.data;m(0===e?s:e=>[...e,...s]),V(o),F(s.length>0),W(e+1)}catch(t){console.error("Error fetching tickets:",t),F(!1)}finally{Z(!1)}}};(0,s.useEffect)(()=>{m([]),W(0),F(!0),ae(0)},[$,J]),(0,s.useEffect)(()=>{window.scrollTo({top:0,behavior:"smooth"})},[$]);const le=(0,s.useRef)(),ie=(0,s.useCallback)(e=>{B||(le.current&&le.current.disconnect(),le.current=new IntersectionObserver(e=>{e[0].isIntersecting&&P&&ae(_)}),e&&le.current.observe(e))},[B,P,_]),ne=e=>{J?(O(e),m([]),H.current=0,F(!0),f(null),t("history"),U("Assigned Tickets"===e?`/tickets/role/${X}/${J}`:`/tickets/employee/${J}`)):console.error(" empID is undefined, cannot navigate")};(0,s.useEffect)(()=>{null!==G&&void 0!==G&&G.permissions&&Y(G.permissions)},[G]);const ce=(()=>{let e=[...r];if(""!==A.trim()){const t=A.toLowerCase();e=e.filter(e=>(e.title||"").toLowerCase().includes(t)||(e.status||"").toLowerCase().includes(t)||(e.priority||"").toLowerCase().includes(t))}"all"!==E&&(e=e.filter(e=>(e.status||"").toLowerCase()===E));const t=new Date;if("Today"===w&&(e=e.filter(e=>new Date(e.sentAt||e.createdAt).toDateString()===t.toDateString())),"Last 7 days"===w){const r=new Date;r.setDate(t.getDate()-7),e=e.filter(e=>{const s=new Date(e.sentAt||e.createdAt);return s>=r&&s<=t})}if("Last 30 days"===w){const r=new Date;r.setDate(t.getDate()-30),e=e.filter(e=>{const s=new Date(e.sentAt||e.createdAt);return s>=r&&s<=t})}if(j){const t=new Date(j);e=e.filter(e=>new Date(e.sentAt||e.createdAt)>=t)}if(N){const t=new Date(N);t.setHours(23,59,59,999),e=e.filter(e=>new Date(e.sentAt||e.createdAt)<=t)}return e.sort((e,t)=>new Date(e.sentAt||e.createdAt)-new Date(t.sentAt||t.createdAt)),e})(),de=K,ue=ce.filter(e=>"resolved"===(e.status||"").trim().toLowerCase()).length,ge=de-ue;return(0,g.jsx)("div",{className:"min-h-screen transition-colors duration-300 "+(te?"bg-gray-900 text-white":"bg-gradient-to-br from-blue-50 via-white to-purple-100 text-gray-900"),children:(0,g.jsxs)("div",{className:"flex flex-row-reverse max-w-7xl mx-auto px-4 py-8 gap-4",children:["ROLE_EMPLOYEE"!==X&&(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)("aside",{className:`sm:flex flex-col border-l transition-all duration-200 hidden sm:flex sm:sticky sm:top-0 h-full ${te?"bg-gray-800 border-gray-700 text-gray-200":"bg-white border-gray-200 text-gray-900"} ${C?"w-[60px]":"w-[250px]"}`,children:[(0,g.jsx)("div",{className:"flex justify-start p-1.5 items-center",children:(0,g.jsx)(c.P.button,{onClick:()=>I(!C),className:"text-gray-500 hover:text-gray-700 focus:outline-none p-1.5 rounded-full hover:bg-gray-100",transition:{duration:.3},children:C?(0,g.jsx)(n.QVr,{size:14}):(0,g.jsx)(n.Z0P,{size:14})})}),(0,g.jsx)("nav",{className:"flex-1 space-y-1.5 px-1.5",children:re.map(e=>{let{tab:t,icon:r}=e;return(0,g.jsxs)(c.P.button,{className:`w-full text-left py-2 px-2 rounded-md font-medium flex items-center transition-colors\n                ${$===t?"bg-blue-600 text-white":""+(te?"text-white hover:bg-gray-700":"text-black hover:bg-gray-200")}\n                ${C?"justify-center":""}`,onClick:()=>ne(t),whileHover:{x:C?0:-3},children:[(0,g.jsx)(r,{size:14,className:C?"":"mr-2"}),!C&&t]},t)})})]})}),(0,g.jsxs)("main",{className:"flex-1 space-y-8",children:[(0,g.jsx)("div",{className:"rounded-xl shadow p-6 border flex flex-col lg:flex-row items-center justify-between gap-6 "+(te?"bg-gray-800 border-gray-700  text-white":"bg-white border-gray-200 text-gray-900"),children:(0,g.jsxs)("div",{className:"flex flex-col lg:flex-row items-center gap-4 w-full flex-wrap",children:[(0,g.jsx)("label",{className:"text-sm font-medium text-gray-700\n                 "+(te?"bg-gray-800 border-gray-700  text-white":"bg-white border-gray-200 text-gray-900"),htmlFor:"search",children:"Search"}),(0,g.jsx)("input",{id:"search",type:"text",value:A,onChange:e=>T(e.target.value),placeholder:"Title, status, priority...",className:"border border-gray-300 text-sm rounded-lg p-2.5 w-64 focus:outline-none focus:ring-2 focus:ring-blue-400"}),(0,g.jsx)("label",{className:`text-sm font-medium   ${te?"bg-gray-800 border-gray-700  text-white":"bg-white border-gray-200 text-gray-900"} `,htmlFor:"date-filter",children:"Filter by Date"}),(0,g.jsxs)("select",{id:"date-filter",className:`border border-gray-300 text-sm rounded-lg p-2.5 w-42 focus:outline-none focus:ring-2 focus:ring-blue-400\n                \n                 ${te?"bg-gray-800 border-gray-700  text-white":"bg-white border-gray-200 text-gray-900"}\n                `,value:w,onChange:e=>v(e.target.value),children:[(0,g.jsx)("option",{children:"All"}),(0,g.jsx)("option",{children:"Last 30 days"}),(0,g.jsx)("option",{children:"Last 7 days"}),(0,g.jsx)("option",{children:"Today"})]}),(0,g.jsx)("label",{className:"text-sm font-medium text-gray-700 \n                 "+(te?"bg-gray-800 border-gray-700  text-white":"bg-white border-gray-200 text-gray-900"),htmlFor:"from-date",children:"From"}),(0,g.jsx)("input",{type:"date",id:"from-date",value:j,onChange:e=>k(e.target.value),className:"border text-sm rounded-lg p-2.5 w-44 focus:outline-none focus:ring-2 focus:ring-blue-400\n    "+(te?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300 text-black")}),(0,g.jsx)("label",{className:"text-sm font-medium text-gray-700\n                 "+(te?"bg-gray-800 border-gray-700  text-white":"bg-white border-gray-200 text-gray-900"),htmlFor:"to-date",children:"To"}),(0,g.jsx)("input",{type:"date",id:"to-date",value:N,onChange:e=>S(e.target.value),className:"border border-gray-300 text-sm rounded-lg p-2.5 w-44 focus:outline-none focus:ring-2 focus:ring-blue-400"}),(0,g.jsx)("div",{className:"flex gap-2 ml-4",children:Object.keys(oe).map(e=>(0,g.jsxs)(c.P.button,{className:"flex items-center gap-1 px-3 py-2 rounded-lg text-sm font-medium transition-colors\n                      "+(E===e?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>D(e),whileHover:{scale:1.05},children:[oe[e],(0,g.jsx)("span",{children:se[e]})]},e))})]})}),(0,g.jsx)("div",{className:"sm:hidden flex gap-2 overflow-x-auto py-2 px-1",children:re.map(e=>{let{tab:t,icon:r}=e;return(0,g.jsxs)(c.P.button,{onClick:()=>ne(t),className:"flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium whitespace-nowrap\n          "+($===t?"bg-blue-600 text-white":""+(te?"bg-gray-800 text-white hover:bg-gray-700":"bg-gray-100 text-black hover:bg-gray-200")),whileHover:{scale:1.02},children:[(0,g.jsx)(r,{size:16}),t]},t)})}),(0,g.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6 ",children:[(0,g.jsxs)("div",{className:"flex items-center gap-4 p-6 rounded-2xl shadow-lg border border-blue-200 \n               "+(te?"bg-gray-800 border-gray-700  text-white":"bg-white border-gray-200 text-gray-900"),children:[(0,g.jsx)("div",{className:"bg-blue-100 text-blue-600 p-4 rounded-full\n                   "+(te?"bg-gray-800 border-gray-700  text-white":"bg-white border-gray-200 text-gray-900"),children:(0,g.jsx)(o.A,{size:32})}),(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"text-sm text-gray-500\n                   "+(te?"bg-gray-800 border-gray-700  text-white":"bg-white border-gray-200 text-gray-900"),children:"Your Tickets"}),(0,g.jsx)("h3",{className:"text-4xl font-bold text-blue-700",children:de})]})]}),(0,g.jsxs)("div",{className:"flex items-center gap-4 p-6 rounded-2xl shadow-lg border border-emerald-200  "+(te?"bg-gray-800 border-gray-700  text-white":"bg-white border-gray-200 text-gray-900"),children:[(0,g.jsx)("div",{className:"bg-emerald-100 text-emerald-600 p-4 rounded-full",children:(0,g.jsx)(l.A,{size:32})}),(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"text-sm text-gray-500",children:"Resolved"}),(0,g.jsx)("h3",{className:"text-4xl font-bold text-emerald-600",children:ue})]})]}),(0,g.jsxs)("div",{className:`flex items-center gap-4 p-6 rounded-2xl shadow-lg border border-red-200 \n               ${te?"bg-gray-800 border-gray-700  text-white":"bg-white border-gray-200 text-gray-900"} `,children:[(0,g.jsx)("div",{className:"bg-red-100 text-red-600 p-4 rounded-full",children:(0,g.jsx)(i.A,{size:32})}),(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"text-sm text-gray-500",children:"Unresolved"}),(0,g.jsx)("h3",{className:"text-4xl font-bold text-red-600",children:ge})]})]})]}),"history"===e&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{className:"flex justify-between items-center",children:[(0,g.jsx)("h2",{className:"text-2xl font-bold "+(te?"text-blue-300":"text-blue-700"),children:"Ticket History"}),q.includes("CREATE_TICKET")&&(0,g.jsx)("button",{onClick:()=>t("form"),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-full text-xl shadow hover:scale-105 transition",children:"+"})]}),(0,g.jsx)("div",{className:(te?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-200 text-gray-900")+" p-6 rounded-2xl shadow-lg",children:(0,g.jsx)(b,{tickets:[...ce].reverse(),onTicketClick:e=>{f(e),t("chat")},lastTicketRef:ie})})]}),"form"===e&&(0,g.jsxs)("div",{className:"space-y-4",children:[(0,g.jsxs)("div",{className:"flex justify-between items-center",children:[(0,g.jsx)("h2",{className:"text-2xl font-bold text-blue-700",children:"Raise a Ticket"}),(0,g.jsx)("button",{onClick:()=>t("history"),className:"text-blue-600 hover:text-blue-800 border border-blue-600 hover:border-blue-800 px-4 py-1 rounded-full text-sm shadow",children:"\u2190 Back to History"})]}),(0,g.jsx)("div",{className:" p-6 rounded-2xl shadow-lg border border-gray-200",children:(0,g.jsx)(h,{onSubmit:async e=>{try{let r=Array.isArray(e.roles)?e.roles[0]:e.roles||"";if(!r)return;r=r.toUpperCase().startsWith("ROLE_")?r.toUpperCase():"ROLE_"+r.toUpperCase();const s={...e,status:"OPEN",employeeId:J,roles:r},o=await fetch("https://hrms.anasolconsultancyservices.com/api/ticket/employee/create",{method:"POST",headers:{Authorization:`Bearer ${ee}`,"Content-Type":"application/json"},body:JSON.stringify(s)});if(!o.ok)throw new Error(`Failed to create ticket: ${o.status}`);const a=await o.json();m(e=>[a,...e]),V(e=>e+1),t("history")}catch(r){console.error(r),alert("Ticket creation failed.")}}})})]}),"chat"===e&&p&&(0,g.jsxs)("div",{className:"space-y-4",children:[(0,g.jsxs)("div",{className:"flex justify-between items-center",children:[(0,g.jsxs)("h2",{className:"text-2xl font-bold text-blue-700",children:["Chat with Admin (Ticket #",p.employeeId,")"]}),(0,g.jsx)("button",{onClick:()=>t("history"),className:"text-blue-600 hover:text-blue-800 border border-blue-600 hover:border-blue-800 px-4 py-1 rounded-full text-sm shadow",children:"\u2190 Back to History"})]}),(0,g.jsx)("div",{className:" p-6 rounded-2xl shadow-lg border border-gray-200",children:(0,g.jsx)(x,{userRole:"employee",ticketId:p.ticketId,ticketStatus:p.status})})]})]})]})})}},6833:(e,t,r)=>{r.d(t,{A:()=>s});const s=(0,r(7784).A)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},7719:(e,t,r)=>{r.d(t,{A:()=>s});const s=(0,r(7784).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])}}]);
//# sourceMappingURL=708.b757445c.chunk.js.map