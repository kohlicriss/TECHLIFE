"use strict";(self.webpackChunktechlife=self.webpackChunktechlife||[]).push([[733],{2733:(e,t,a)=>{a.r(t),a.d(t,{default:()=>O});var s=a(5043),r=a(3895),l=a(9657),n=(a(2157),a(4050)),o=a(6992),i=a(6102),c=a(7869),d=a(379),x=a(2647),m=a(1474),g=a(2185),h=a(6026),u=a(1175),p=a(6446),y=a(9570),b=(a(7249),a(9722)),v=a(1357),f=a(7234),j=a(7158),w=a(9463),N=a(8326),k=a(3156),S=a(579);const D=e=>{let{leave:t,onClose:a}=e;const{theme:r}=(0,s.useContext)(f.ob);return t?(0,S.jsx)(y.N,{children:(0,S.jsx)(p.P.div,{className:"fixed inset-0 z-50 flex items-center justify-center  bg-opacity-25 backdrop-blur-sm",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,S.jsxs)(p.P.div,{className:" ".concat("dark"===r?"bg-gray-500 text-gray-200":"bg-stone-100"," rounded-lg shadow-xl p-6 max-w-lg w-full relative"),initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},children:[(0,S.jsx)("button",{onClick:a,className:"w-20 h-20 absolute top-3 right-3 ".concat("dark"===r?"text-gray-200":"text-gray-500"," hover:text-gray-700 text-xl"),children:(0,S.jsx)(k.XoR,{className:"w-8 h-8"})}),(0,S.jsx)("h2",{className:"text-2xl font-bold mb-4 ".concat("dark"===r?"text-gray-200":"text-gray-800"),children:"Leave Request Summary"}),(0,S.jsxs)("div",{className:"space-y-2",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("strong",{children:"Request By:"})," ",t.request_By]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("strong",{children:"Leave Type:"})," ",t.leave_type]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("strong",{children:"Leave On:"})," ",t.leave_on]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("strong",{children:"Status:"})," ",t.status]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("strong",{children:"Action Date:"})," ",t.action_Date]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("strong",{children:"Reason:"}),t.leave_Reason||"-"," "]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("strong",{children:"Action:"})," ",t.rejection_Reason||"-"]})]})]})})}):null};var C=a(184),_=a(8877),A=a(2397),L=a(4921);const R=e=>{let{label:t,theme:a,children:s,helperText:r,className:l=""}=e;return(0,S.jsxs)("div",{className:"space-y-1 ".concat(l),children:[(0,S.jsx)("label",{className:"block text-sm font-medium ".concat("dark"===a?"text-gray-200":"text-gray-700"),children:t}),s,r&&(0,S.jsx)("p",{className:"text-xs mt-1 italic ".concat("dark"===a?"text-gray-400":"text-gray-500"),children:r})]})},I=e=>"w-full px-4 py-3 border rounded-lg text-sm \n    focus:ring-2 focus:ring-blue-500/40 focus:border-blue-500 focus:outline-none \n    ".concat("dark"===e?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-800"),E=e=>{let{onClose:t,onAddLeave:a}=e;const{userData:r,theme:l}=(0,s.useContext)(f.ob),n=(null===r||void 0===r?void 0:r.employee_id)||(null===r||void 0===r?void 0:r.employeeId)||"",[o,i]=(0,s.useState)(n),[c,d]=(0,s.useState)(""),[x,m]=(0,s.useState)(""),[g,h]=(0,s.useState)(""),[u,y]=(0,s.useState)(""),[v,j]=(0,s.useState)(!1),[w,N]=(0,s.useState)(!1),[k,D]=(0,s.useState)(null),C=()=>{if(!c||!x)return 1;const e=new Date(c),t=new Date(x),a=Math.floor((t-e)/864e5)+1;return Math.max(1,a)},_="dark"===l?"bg-gray-800 text-white border-gray-700":"bg-white text-gray-800 border-gray-100";return(0,S.jsx)(p.P.div,{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/30 backdrop-blur-sm",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t,"aria-hidden":!0,children:(0,S.jsx)(p.P.div,{className:"relative w-full max-w-xl mx-auto my-auto max-h-[90vh] overflow-y-auto z-60 transform",initial:{scale:.97,y:-8,opacity:0},animate:{scale:1,y:0,opacity:1},exit:{scale:.97,y:-8,opacity:0},onClick:e=>e.stopPropagation(),children:(0,S.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),D(null),!o)return D("Employee ID required");if(!c||!x)return D("Select From and To dates");if(!g)return D("Select leave type");const s={employeeId:o,numberOfDays:C(),req_To_from:c,req_To_to:x,leave_Reason:u,isHalf_Day:!!v,leave_Type:g};N(!0);const l="https://hrms.anasolconsultancyservices.com/api/attendance/employee/leaveRequest/".concat(o),n={"Content-Type":"application/json"};try{var i,d,m,h;let e;try{const e=await(null!==A.HN&&void 0!==A.HN&&A.HN.post?A.HN.post(l,s,{headers:n}):b.A.post(l,s,{headers:n}));if(200!==e.status&&201!==e.status){var p;const t="string"===typeof e.data?e.data:(null===(p=e.data)||void 0===p?void 0:p.message)||"Unexpected error occurred.";throw alert("Error: ".concat(t)),new Error(t)}alert("Request completed successfully \ud83c\udf89")}catch(k){var y;console.error("Submission Error:",k);const t=null!==(y=k.response)&&void 0!==y&&y.data?"string"===typeof k.response.data?k.response.data:k.response.data.message:k.message;alert("Error: ".concat(t))}const x="leaveHistory_".concat(o),u=JSON.parse(localStorage.getItem(x))||[],v={status:(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.status)||"pending",details:(null===e||void 0===e||null===(d=e.data)||void 0===d?void 0:d.details)||"".concat(g," leave"),action:(null===e||void 0===e||null===(m=e.data)||void 0===m?void 0:m.action)||"-",leave_type:g,leave_on:c,request_By:(null===r||void 0===r?void 0:r.fullName)||o,action_Date:(new Date).toISOString().slice(0,10),rejection_Reason:(null===e||void 0===e||null===(h=e.data)||void 0===h?void 0:h.rejection_Reason)||""};localStorage.setItem(x,JSON.stringify([v,...u])),"function"===typeof a&&a(v),t&&t()}catch(w){var f,j;console.error("Leave request failed:",w),D((null===w||void 0===w||null===(f=w.response)||void 0===f||null===(j=f.data)||void 0===j?void 0:j.message)||w.message||"Request failed")}finally{N(!1)}},className:"relative w-full rounded-3xl shadow-3xl overflow-hidden ".concat(_," transition-all duration-300"),children:[(0,S.jsxs)("div",{className:"text-center rounded-t-3xl ".concat("bg-gradient-to-r from-blue-500 to-blue-600"," p-6"),children:[(0,S.jsxs)("h2",{className:"text-2xl font-extrabold text-white flex items-center justify-center",children:[(0,S.jsx)("i",{className:"fas fa-plane-departure mr-3"})," Request Employee Leave"]}),(0,S.jsx)("p",{className:"text-sm text-white/90 mt-1",children:"Fill out the details below to submit your leave request."})]}),(0,S.jsxs)("div",{className:"space-y-6 p-8",children:[(0,S.jsx)(R,{label:"Employee ID",theme:l,helperText:"This is automatically fetched from your profile.",children:(0,S.jsx)("input",{type:"text",value:o,onChange:e=>i(e.target.value),className:"".concat(I(l)," bg-gray-300  cursor-not-allowed"),readOnly:!0})}),(0,S.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,S.jsx)(R,{label:"From Date",theme:l,children:(0,S.jsx)("input",{type:"date",value:c,onChange:e=>d(e.target.value),className:I(l),required:!0})}),(0,S.jsx)(R,{label:"To Date",theme:l,helperText:"Duration: ".concat(C()," day(s)"),children:(0,S.jsx)("input",{type:"date",value:x,onChange:e=>m(e.target.value),className:I(l),min:c,required:!0})})]}),(0,S.jsxs)("div",{className:"grid grid-cols-2 gap-6 items-end",children:[(0,S.jsx)(R,{label:"Leave Type",theme:l,children:(0,S.jsxs)("select",{value:g,onChange:e=>h(e.target.value),className:"".concat(I(l)," h-12 appearance-none"),required:!0,children:[(0,S.jsx)("option",{value:"",className:"".concat("dark"===l?"bg-gray-700 text-white":"bg-white text-gray-800"),disabled:!0,hidden:!0,children:"Select Type"}),(0,S.jsx)("option",{value:"SICK",className:"".concat("dark"===l?"bg-gray-700 text-white":"bg-white text-gray-800"),children:"SICK"}),(0,S.jsx)("option",{value:"CASUAL",className:"".concat("dark"===l?"bg-gray-700 text-white":"bg-white text-gray-800"),children:"CASUAL"}),(0,S.jsx)("option",{value:"UNPAID",className:"".concat("dark"===l?"bg-gray-700 text-white":"bg-white text-gray-800"),children:"UNPAID"}),(0,S.jsx)("option",{value:"PAID",className:"".concat("dark"===l?"bg-gray-700 text-white":"bg-white text-gray-800"),children:"PAID"})]})}),(0,S.jsxs)("div",{className:"flex items-center pt-6",children:[(0,S.jsx)("input",{id:"isHalfDay",type:"checkbox",checked:v,onChange:e=>j(e.target.checked),className:"h-5 w-5 rounded border-gray-300 text-red-600 focus:ring-red-500"}),(0,S.jsx)("label",{htmlFor:"isHalfDay",className:"ml-2 block text-sm font-medium cursor-pointer ".concat("dark"===l?"text-gray-200":"text-gray-700"),children:"Is this a Half Day leave?"})]})]}),(0,S.jsx)(R,{label:"Reason for Leave",theme:l,children:(0,S.jsx)("textarea",{value:u,onChange:e=>y(e.target.value),className:"".concat(I(l)," min-h-[100px]"),required:!0,placeholder:"Briefly describe your reason for taking leave..."})}),k&&(0,S.jsx)("div",{className:"mt-3 text-sm text-red-600",children:k}),(0,S.jsxs)("div",{className:"pt-4 flex justify-end space-x-4 border-t border-gray-200 dark:border-gray-700 -mx-8 px-8",children:[(0,S.jsx)(p.P.button,{type:"button",onClick:t,className:"px-5 py-2.5 rounded-lg border text-sm font-semibold shadow-sm transition-colors hover:bg-gray-100  dark:border-gray-600",whileHover:{scale:1.05},whileTap:{scale:.95},children:"Cancel"}),(0,S.jsx)(p.P.button,{type:"submit",className:"px-5 py-2.5 rounded-lg border border-transparent bg-blue-600 text-sm font-semibold text-white shadow-md hover:bg-blue-700 disabled:opacity-50 disabled:bg-red-400 transition-colors",disabled:w,whileHover:{scale:1.05},whileTap:{scale:.95},children:w?"Sending Request...":"Submit Leave Request"})]})]})]})})})},P=e=>{let{title:t,leaveData:a={type:t,consumed:0,remaining:0,total:0},color:x}=e;(0,r.A)("(max-width:500px)");const{type:m,consumed:g,remaining:h,total:u}=a,y=[{name:"Consumed",value:g},{name:"Remaining",value:Math.max(u-g,0)}],b=["#8884d8","#82ca9d","#ffc658","#ff8042","#a4de6c"],{theme:v}=(0,s.useContext)(f.ob);return(0,S.jsxs)(p.P.div,{className:"rounded-xl shadow-lg p-6 h-full flex flex-col items-center justify-center border border-gray-200 hover:border-indigo-500 hover:shadow-2xl transition-all duration-300 ease-in-out ".concat("dark"===v?"bg-gray-600":"bg-stone-100 text-gray-800"),initial:{opacity:0,y:50},animate:{opacity:1,y:0},children:[(0,S.jsx)("h1",{className:"text-xl font-bold mb-4 text-center ".concat("dark"===v?"bg-gradient-to-br from-yellow-100 to-yellow-400 bg-clip-text text-transparent border-gray-100":"text-gray-700"),children:t}),(0,S.jsx)(l.A,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",className:"w-full",children:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(n.u,{width:140,height:140,children:(0,S.jsxs)(o.r,{children:[(0,S.jsx)(i.F,{data:y,cx:"50%",cy:"50%",innerRadius:30,outerRadius:60,paddingAngle:3,dataKey:"value",stroke:"none",className:"ml-0",children:y.map((e,t)=>(0,S.jsx)(c.f,{fill:b[t]},"cell-".concat(t)))}),(0,S.jsx)("text",{x:"50%",y:"50%",textAnchor:"middle",dominantBaseline:"middle",className:"text-lg font-semibold ".concat("dark"===v?"text-gray-200":"text-gray-700"),children:m.split(" ")[0]}),(0,S.jsx)(d.m,{})]})}),(0,S.jsxs)("div",{className:"text-center mt-4 space-y-2 text-sm ".concat("dark"===v?"text-white":"text-gray-700"),children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("strong",{children:"Consumed:"})," ",(0,S.jsx)("span",{className:"font-semibold text-sm text-red-600",children:g})," ","days"]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("strong",{children:"Available:"})," ",(0,S.jsxs)("span",{className:"font-semibold text-sm text-green-600",children:[" ",h]})," ","days"]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("strong",{children:"Total:"})," ",u," days"]})]})]})})]})},T=()=>{const e=["#8884d8","#82ca9d","#ffc658","#ff8042","#a4de6c"],{empID:t}=(0,v.g)(),{userData:a,theme:m}=(0,s.useContext)(f.ob),[g,h]=(0,s.useState)([]),[u,y]=(0,s.useState)(!0);(0,s.useEffect)(()=>{const e="https://hrms.anasolconsultancyservices.com/api/attendance/employee/".concat(null===a||void 0===a?void 0:a.employeeId,"/personalLeavesData");A.HN.get(e).then(e=>{const t=e.data.map(e=>({name:e.leaveType,value:e.days}));h(t)}).catch(e=>{console.error("Error fetching personal leave data:",e)}).finally(()=>{y(!1)})},[t]);const b=(0,r.A)("(max-width:768px)"),j=g.filter(e=>e.value>0);return(0,S.jsxs)(p.P.div,{className:" rounded-xl shadow-lg p-6 h-full flex flex-col border border-gray-200 hover:border-indigo-500 hover:shadow-2xl transition-all duration-300 ease-in-out ".concat("dark"===m?"bg-gray-600":"bg-stone-100 text-gray-800"),initial:{opacity:0,y:50},animate:{opacity:1,y:0},children:[(0,S.jsx)("h1",{className:"text-2xl font-bold mb-4 text-center ".concat("dark"===m?"bg-gradient-to-br from-purple-100 to-purple-400 bg-clip-text text-transparent border-gray-100":"text-gray-700 border-gray-200"," border-b pb-4"),children:"Leave Type Breakdown"}),(0,S.jsx)(l.A,{display:"flex",flexDirection:b?"column":"row",justifyContent:"center",alignItems:"center",height:"100%",gap:2,p:1,children:u?(0,S.jsx)("div",{className:"text-gray-500 text-center w-full",children:"Loading..."}):j.length>0?(0,S.jsx)(n.u,{width:"100%",height:250,children:(0,S.jsxs)(o.r,{children:[(0,S.jsx)(i.F,{data:j,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,fill:"#8884d8",dataKey:"value",paddingAngle:2,labelLine:!1,label:e=>{let{name:t,percent:a}=e;return"".concat(t," ").concat((100*a).toFixed(0),"%")},children:j.map((t,a)=>(0,S.jsx)(c.f,{fill:e[a%e.length]},"cell-".concat(a)))}),(0,S.jsx)(x.JU,{content:()=>(0,S.jsx)("text",{x:"50%",y:"50%",textAnchor:"middle",dominantBaseline:"middle",className:"text-base font-semibold text-gray-700",children:"Leave Types"}),position:"center"}),(0,S.jsx)(d.m,{})]})}):(0,S.jsx)("div",{className:" text-center w-full ".concat("dark"===m?"text-white":"text-gray-500"," italic"),children:"No leave data available."})})]})},q=()=>{const{employeeId:e}=(0,v.g)(),{userData:t,theme:a}=(0,s.useContext)(f.ob),[o,i]=(0,s.useState)("All"),[c,x]=(0,s.useState)([]),[y,b]=(0,s.useState)(!0),[j,w]=(0,s.useState)(null),N="dark"===a?"#FFFFFF":"#000000";(0,s.useEffect)(()=>{const e="https://hrms.anasolconsultancyservices.com/api/attendance/employee/".concat(null===t||void 0===t?void 0:t.employeeId,"/leavesbar-graph");return A.HN.get(e).then(e=>{const t=e.data.map(e=>({Day:e.day,Rate:e.rate}));x(t),console.log("Give me Weekly pattern:",t)}).catch(e=>{console.error("Error fetching leaves bar chart data:",e);const t=e.response?"Error: ".concat(e.response.status," - ").concat(e.response.statusText):"Failed to load weekly leave pattern data.";w(t)}).finally(()=>{b(!1)}),()=>{}},[e]);const k=(0,r.A)("(max-width:768px)"),D=["All",...new Set(c.map(e=>e.Day))],C="All"===o?c:c.filter(e=>e.Day===o);return(0,S.jsxs)(p.P.div,{className:" shadow-lg rounded-xl p-6 h-full flex flex-col border border-gray-200 hover:border-indigo-500 hover:shadow-2xl transition-all duration-300 ease-in-out ".concat("dark"===a?"bg-gray-600":"bg-stone-100 text-gray-800"),initial:{opacity:0,y:50},animate:{opacity:1,y:0},children:[(0,S.jsx)("h1",{className:"text-2xl font-bold mb-4 text-center ".concat("dark"===a?"bg-gradient-to-br from-purple-100 to-purple-400 bg-clip-text text-transparent border-gray-100":"text-gray-700 border-gray-200"," border-b pb-4"),children:"Weekly Leave Pattern"}),(0,S.jsxs)("div",{className:"mb-4 text-center",children:[(0,S.jsx)("label",{className:"mr-2 font-semibold  ".concat("dark"===a?"text-white":"text-gray-700"),children:"Select Day:"}),(0,S.jsx)("select",{value:o,onChange:e=>i(e.target.value),className:"p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500 ".concat("dark"===a?"text-white":" text-gray-800 "),disabled:y||j,children:D.map(e=>(0,S.jsx)("option",{value:e,children:e},e))})]}),(0,S.jsx)(l.A,{display:"flex",flexDirection:k?"column":"row",justifyContent:"center",alignItems:"center",height:"100%",gap:5,p:k?1:2,children:C.length>0?(0,S.jsx)(n.u,{width:"100%",height:230,children:(0,S.jsxs)(m.E,{data:C,margin:{top:10,right:10,left:10,bottom:0},children:[(0,S.jsx)(g.W,{dataKey:"Day",axisLine:!1,tickLine:!1,stroke:N,className:"text-sm text-gray-600"}),(0,S.jsx)(h.h,{hide:!0}),(0,S.jsx)(d.m,{contentStyle:{backgroundColor:"dark"===a?"#63676cff":"#fff",border:a?"1px solid #4B5563":"1px solid #ccc"}}),(0,S.jsx)(u.y,{dataKey:"Rate",fill:"#69d6dbff",radius:[8,8,0,0]})]})}):(0,S.jsx)("div",{className:" text-center w-full ".concat("dark"===a?"text-white":"text-gray-500"," italic"),children:"No weekly leave pattern data available."})})]})},H=e=>{let{leaveHistoryData:t}=e;const[a,r]=(0,s.useState)(1),[l,n]=(0,s.useState)("All"),[o,i]=(0,s.useState)("All"),[c,d]=(0,s.useState)("Recently added"),[x,m]=(0,s.useState)(10),[g,h]=(0,s.useState)(!1),{empID:u}=(0,v.g)(),[p,y]=(0,s.useState)(null),{theme:b}=(0,s.useContext)(f.ob),j=["All",...new Set(t.map(e=>e.leave_type))],w=["All",...new Set(t.map(e=>e.status))],N=()=>{y(null)},k=(()=>{let e=[...t];switch(e=e.filter(e=>("All"===l||e.leave_type===l)&&("All"===o||e.status===o)),c){case"Ascending":e.sort((e,t)=>e.leave_type.localeCompare(t.leave_type));break;case"Descending":e.sort((e,t)=>t.leave_type.localeCompare(e.leave_type));break;case"Last Month":const t=new Date;t.setMonth(t.getMonth()-1),e=e.filter(e=>new Date(e.leave_On)>=t);break;case"Last 7 Days":const a=new Date;a.setDate(a.getDate()-7),e=e.filter(e=>new Date(e.leave_On)>=a);break;default:e.sort((e,t)=>new Date(t.action_Date)-new Date(e.action_Date))}return e})(),_=Math.ceil(k.length/x),A=k.slice((a-1)*x,a*x);return(0,S.jsxs)("div",{className:"shadow-lg rounded-xl p-6 border ".concat("dark"===b?"bg-gray-600":"bg-white"),children:[(0,S.jsx)("h2",{className:"text-2xl font-bold mb-4 text-left border-b pb-4 ".concat("dark"===b?"bg-gradient-to-br from-green-400 to-green-800 bg-clip-text text-transparent border-gray-100":"text-gray-800 border-gray-200"," "),children:"Leave Requests History"}),(0,S.jsxs)("div",{className:"flex flex-wrap items-center gap-4 mb-6",children:[(0,S.jsxs)("div",{className:"relative",children:[(0,S.jsx)("label",{className:"text-base font-semibold mr-2 ".concat("dark"===b?"text-white":"text-gray-700"),children:"Leave Type:"}),(0,S.jsx)("select",{value:l,onChange:e=>n(e.target.value),className:"px-3 py-1.5 rounded-md focus:ring-indigo-500 focus:border-indigo-500 text-gray-700 border ".concat("dark"===b?"border-black  bg-gray-500 text-white":"border-gray-300"),children:j.map(e=>(0,S.jsx)("option",{value:e,children:e},e))})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"text-base font-semibold mr-2 ".concat("dark"===b?"text-white":"text-gray-700"),children:"Status:"}),(0,S.jsx)("select",{value:o,onChange:e=>i(e.target.value),className:"px-3 py-1.5 rounded-md focus:ring-indigo-500 focus:border-indigo-500 text-gray-700 border ".concat("dark"===b?"border-black bg-gray-500 text-white":"border-gray-300"),children:w.map(e=>(0,S.jsx)("option",{value:e,children:e},e))})]}),(0,S.jsxs)("div",{className:"relative",children:[(0,S.jsx)("label",{className:"text-base font-semibold mr-2 ".concat("dark"===b?"text-white":"text-gray-700"),children:"Sort by:"}),(0,S.jsx)("select",{value:c,onChange:e=>d(e.target.value),className:"px-3 py-1.5 rounded-md focus:ring-indigo-500 focus:border-indigo-500 text-gray-700 ".concat("dark"===b?"border-black  bg-gray-500 text-white":"border-gray-300"," border"),children:["Recently added","Ascending","Descending","Last Month","Last 7 Days"].map(e=>(0,S.jsx)("option",{value:e,children:e},e))})]})]}),(0,S.jsx)("div",{className:"overflow-x-auto rounded-xl",children:(0,S.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 broder border-gray-200",children:[(0,S.jsx)("thead",{className:"bg-gray-50 ".concat("dark"===b?"border-black  bg-gray-500 text-white":""),children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider ".concat("dark"===b?"text-white":""),children:"Status"}),(0,S.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider ".concat("dark"===b?"text-white":""),children:"Details"}),(0,S.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider ".concat("dark"===b?"text-white":""),children:"Action"}),(0,S.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider ".concat("dark"===b?"text-white":""),children:"Leave Type"}),(0,S.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider ".concat("dark"===b?"text-white":""),children:"Leave On"}),(0,S.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider ".concat("dark"===b?"text-white":""),children:"Request By"}),(0,S.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider ".concat("dark"===b?"text-white":""),children:"Action Date"}),(0,S.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider ".concat("dark"===b?"text-white":""),children:"Rejection Reason"}),(0,S.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider ".concat("dark"===b?"text-white":""),children:"LeaveDetails"})]})}),(0,S.jsx)("tbody",{className:"bg-white divide-y divide-gray-500",children:A.length>0?A.map((e,t)=>(0,S.jsxs)("tr",{children:[(0,S.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm  ".concat("dark"===b?" bg-gray-500 text-gray-200":"text-gray-900"),children:(0,S.jsxs)("span",{className:"px-2 py-1 rounded-full text-white text-xs font-semibold ".concat("APPROVED"===e.status?"bg-green-500":"rejected"===e.status?"bg-red-500":"bg-blue-500"),children:[" ",e.status]})}),(0,S.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm  ".concat("dark"===b?" bg-gray-500 text-gray-200":"text-gray-900"),children:e.details}),(0,S.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm  ".concat("dark"===b?" bg-gray-500 text-gray-200":"text-gray-900"),children:e.action}),(0,S.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm  ".concat("dark"===b?" bg-gray-500 text-gray-200":"text-gray-900"),children:e.leave_type}),(0,S.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm  ".concat("dark"===b?" bg-gray-500 text-gray-200":"text-gray-900"),children:e.leave_on}),(0,S.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm  ".concat("dark"===b?" bg-gray-500 text-gray-200":"text-gray-900"),children:e.request_By}),(0,S.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm  ".concat("dark"===b?" bg-gray-500 text-gray-200":"text-gray-900"),children:e.action_Date}),(0,S.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm  ".concat("dark"===b?" bg-gray-500 text-gray-200":"text-gray-900"),children:e.rejection_Reason}),(0,S.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-center ".concat("dark"===b?"bg-gray-500 text-gray-200 ":""),children:(0,S.jsx)("button",{onClick:()=>{y(e)},className:"text-indigo-600 hover:text-indigo-800 text-lg",title:"View Details",children:(0,S.jsx)(C.t69,{className:" ".concat("dark"===b?"text-blue-200":"text-blue-600"," text-lg inline w-6 h-6 md:w-6 md:h-6 transition ")})})}),(0,S.jsx)(D,{leave:p,onClose:N})]},t)):(0,S.jsx)("tr",{children:(0,S.jsx)("td",{colSpan:8,className:"text-center py-4 text-gray-500 ".concat("dark"===b?" bg-gray-500 text-white":""," italic"),children:"No leave history found."})})})]})}),(0,S.jsxs)("div",{className:"mt-4 flex flex-col sm:flex-row items-center justify-between",children:[(0,S.jsxs)("div",{className:"flex items-center gap-2 mb-4 sm:mb-0",children:[(0,S.jsx)("span",{className:"text-sm text-gray-700 ".concat("dark"===b?"text-white":"text-gray-700"),children:"Rows per page:"}),(0,S.jsx)("select",{value:x,onChange:e=>{m(Number(e.target.value)),r(1)},className:"border border-gray-300 px-2 py-1 rounded-md text-sm ".concat("dark"===b?"bg-gray-600 text-white border-gray-500":"bg-white text-gray-800"),children:[10,25,50,100].map(e=>(0,S.jsx)("option",{value:e,children:e},e))})]}),(0,S.jsxs)("nav",{className:"flex items-center gap-2",children:[(0,S.jsx)("button",{onClick:()=>r(e=>Math.max(e-1,1)),disabled:1===a,className:"px-4 py-2 text-sm font-medium  border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed ".concat("dark"===b?"bg-gray-600 text-white border-gray-500 hover:bg-gray-500":"bg-white text-gray-800"," "),children:"Previous"}),(0,S.jsxs)("span",{className:"text-sm text-gray-700 ".concat("dark"===b?"text-white":"text-gray-700"),children:["Page ",a," of ",_]}),(0,S.jsx)("button",{onClick:()=>r(e=>Math.min(e+1,_)),disabled:a===_||0===_,className:"px-4 py-2 text-sm font-medium  border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed ".concat("dark"===b?"bg-gray-600 text-white border-gray-500 hover:bg-gray-500":"bg-white text-gray-800"," "),children:"Next"})]})]})]})},F=e=>{let{handleRequestLeave:t}=e;const{userData:a,theme:r}=(0,s.useContext)(f.ob),[l,n]=(0,s.useState)({image:null,initials:" "}),[o,i]=(0,s.useState)(null),[c,d]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("emppayload")),t=localStorage.getItem("loggedInUserImage"),a=((null===e||void 0===e?void 0:e.displayName)||" ").split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase();n({image:t,initials:a})},[a]),(0,s.useEffect)(()=>{null!==a&&void 0!==a&&a.employeeId&&async function(){d(!0);try{const e=(new Date).getMonth()+1,t=(new Date).getFullYear(),s="https://hrms.anasolconsultancyservices.com/api/attendance/getLeaves/".concat(null===a||void 0===a?void 0:a.employeeId,"/").concat(e,"/").concat(t,"?employee_id=").concat(null===a||void 0===a?void 0:a.employeeId,"&month=").concat(e,"&year=").concat(t),r=localStorage.getItem("accessToken"),l={"Content-Type":"application/json"};r&&(l.Authorization="Bearer ".concat(r));const n=await b.A.get(s,{headers:l});if(200!==n.status&&201!==n.status)throw alert("Error: ".concat(n)),new Error("".concat(n.status));i(n.data)}catch(e){i(null)}finally{d(!1)}}()},[null===a||void 0===a?void 0:a.employeeId]),(0,S.jsxs)(p.P.div,{className:"flex flex-col xl:flex-row justify-between items-start xl:items-center p-3 sm:p-4 rounded-2xl shadow-2xl mb-8 transition-all duration-300\n                        ".concat("dark"===r?"bg-gray-800 border-t-4 border-indigo-600":"bg-white border-t-4 border-indigo-600"),initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:[(0,S.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-4 sm:space-y-0 sm:space-x-6 w-full xl:w-3/5 mb-6 xl:mb-0",children:[(0,S.jsx)(p.P.div,{className:"flex-shrink-0 w-16 h-16 sm:w-20 sm:h-20 rounded-full overflow-hidden flex items-center justify-center border-4 \n                        ".concat("dark"===r?"border-gray-700 bg-indigo-700":"border-indigo-100 bg-indigo-600"," shadow-xl"),whileHover:{scale:1.05},children:l.image?(0,S.jsx)("img",{src:l.image,alt:"Profile",className:"w-full h-full object-cover"}):(0,S.jsx)("span",{className:"text-2xl sm:text-3xl font-extrabold text-white",children:l.initials})}),(0,S.jsxs)("div",{className:"flex-1",children:[(0,S.jsxs)("h2",{className:"text-2xl sm:text-4xl font-extrabold flex items-center ".concat("dark"===r?"text-white":"text-gray-800"),children:["Welcome, ",(0,S.jsx)("span",{className:"text-indigo-600 ml-2",children:(null===a||void 0===a?void 0:a.fullName)||"User"}),"!"]}),(0,S.jsx)("p",{className:"text-sm sm:text-base mt-1 ".concat("dark"===r?"text-gray-400":"text-gray-500"),children:"Your monthly attendance summary for a quick glance."}),(0,S.jsx)("div",{className:"mt-4 p-4 rounded-xl transition-colors duration-300 \n                        ".concat("dark"===r?"bg-gray-900/50 backdrop-blur-sm":"bg-indigo-50/70"," border ").concat("dark"===r?"border-gray-700":"border-indigo-200"),children:c?(0,S.jsx)("span",{className:"text-xs font-medium text-indigo-400",children:"Fetching attendance summary..."}):o?(0,S.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-y-3 gap-x-6 text-sm",children:[["Paid","Sick","Casual","Unpaid"].map((e,t)=>(0,S.jsxs)("div",{className:"flex flex-col",children:[(0,S.jsx)("span",{className:"text-xs uppercase font-medium ".concat("dark"===r?"text-gray-400":"text-gray-600"),children:e}),(0,S.jsx)("span",{className:"text-xl font-bold ".concat("dark"===r?"text-indigo-400":"text-indigo-600"),children:o[e.toLowerCase()]})]},e)),(0,S.jsxs)("div",{className:"col-span-2 md:col-span-1 flex flex-col items-start md:items-center p-2 rounded-lg bg-white shadow-inner md:bg-transparent md:shadow-none",children:[(0,S.jsx)("span",{className:"text-xs uppercase font-medium ".concat("dark"===r?"text-gray-400":"text-gray-600"),children:"Shift"}),(0,S.jsx)("span",{className:"text-sm font-semibold mt-1 ".concat("dark"===r?"text-white":"text-gray-800"),children:o.shiftName||"N/A"})]})]}):(0,S.jsx)("span",{className:"text-sm font-medium text-red-500",children:"Could not load attendance summary."})})]})]}),(0,S.jsxs)(p.P.button,{onClick:t,className:"w-full xl:w-auto flex items-center justify-center px-6 py-3 mt-4 xl:mt-0 bg-gradient-to-r from-indigo-500 to-purple-600 text-base text-white font-bold rounded-xl shadow-lg hover:from-indigo-600 hover:to-purple-700 focus:outline-none focus:ring-4 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-white transition-all duration-300 transform active:scale-98",whileHover:{scale:1.05,boxShadow:"0 10px 20px -5px rgba(99, 102, 241, 0.7)"},whileTap:{scale:.98},children:[(0,S.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 inline mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,S.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),"Request New Leave"]})]})},O=()=>{var e;const{theme:t}=(0,s.useContext)(f.ob),[a,r]=(0,s.useState)([]),{empID:l,employeeId:n}=(0,v.g)(),{userData:o}=(0,s.useContext)(f.ob),[i,c]=(0,s.useState)(null),d=((null===o||void 0===o||null===(e=o.roles)||void 0===e?void 0:e[0])||"").toUpperCase(),[x,m]=(0,s.useState)(!1),[g,h]=(0,s.useState)(!1),[u,k]=(0,s.useState)(!1),D=["TEAM_LEAD","HR","MANAGER","ADMIN"].includes(d),[C,R]=(0,s.useState)([]),[I,O]=(0,s.useState)([]),[B,M]=(0,s.useState)(null),U=null!==o&&void 0!==o&&o.roles[0]?"ROLE_".concat(null===o||void 0===o?void 0:o.roles[0]):null;(0,s.useEffect)(()=>{(async()=>{let e=await A.ZQ.get("role-access/".concat(U));console.log("from Employee :",e.data),O(e.data)})()},[]),(0,s.useEffect)(()=>{I&&M(null===I||void 0===I?void 0:I.permissions)},[I]),console.log(B);const[z,J]=(0,s.useState)([]);function K(e){return{status:e.status||"pending",details:e.details||"-",action:e.action||"-",leave_type:e.leave_type||e.leave_Type||"-",leave_on:e.leave_on||e.req_To_from||"-",request_By:e.request_By||e.Request_By||"-",action_Date:e.action_Date||e.Action_Date||"-",rejection_Reason:e.rejection_Reason||e.Rejection_Reason||"-"}}(0,s.useEffect)(()=>{J(null===o||void 0===o?void 0:o.permissions)},[o]),console.log("permissions from userdata:",z),(0,s.useEffect)(()=>{(async()=>{if(null!==o&&void 0!==o&&o.employeeId)try{const e=await A.HN.get("https://hrms.anasolconsultancyservices.com/api/attendance/employee/".concat(null===o||void 0===o?void 0:o.employeeId,"/leaves?page=0&size=10")),t=Array.isArray(e.data)?e.data:[],a="leaveHistory_".concat(o.employeeId),s=JSON.parse(localStorage.getItem(a))||[],r=t.map(K),l=function(e){const t=new Set;return e.filter(e=>{const a="".concat(e.leave_type,"-").concat(e.leave_on,"-").concat(e.status);return!t.has(a)&&(t.add(a),!0)})}([...s.map(K),...r]);R(l)}catch(e){console.error("Failed to fetch leave history:",e),R([])}})()},[null===o||void 0===o?void 0:o.employeeId]);(0,s.useEffect)(()=>{if(null!==o&&void 0!==o&&o.employeeId){const e=localStorage.getItem("leaveHistory_".concat(o.employeeId));R(e?JSON.parse(e):[])}},[null===o||void 0===o?void 0:o.employeeId]),(0,s.useEffect)(()=>{const e=b.A.CancelToken.source();return(async()=>{try{const t=await A.HN.get("https://hrms.anasolconsultancyservices.com/api/attendance/employee/".concat(null===o||void 0===o?void 0:o.employeeId,"/leave-summary"),{cancelToken:e.token});if(200!==t.status&&201!==t.status)throw alert("Error: ".concat(t)),new Error("".concat(t.status));const a={Casual:"Casual Leave",Paid:"Paid Leave",Unpaid:"Unpaid Leave",Sick:"Sick Leave"},s=t.data.map(e=>({type:a[e.type]||e.type,consumed:e.consumed,remaining:e.remaining,total:e.total}));r(s)}catch(t){b.A.isCancel(t)?console.log("Request cancelled",t.message):console.error("Error fetching line chart data:",t)}})(),()=>{e.cancel("Operation canceled by the user.")}},[n]);const[W,Q]=(0,s.useState)(!1),V=a.find(e=>"Casual Leave"===e.type),G=a.find(e=>"Paid Leave"===e.type),Y=a.find(e=>"Sick Leave"===e.type),X=a.find(e=>"Unpaid Leave"===e.type);return(0,S.jsxs)("div",{className:"min-h-screen p-2 sm:p-3 lg:p-4 font-sans ".concat("dark"===t?"bg-gray-900 text-white":"bg-gray-100 text-gray-900"),children:[(0,S.jsxs)(y.N,{children:[D&&!x&&(0,S.jsx)(p.P.button,{onClick:()=>m(!0),className:"fixed right-0 top-1/2 transform -translate-y-1/2 bg-indigo-600 text-white p-2 rounded-l-lg shadow-lg z-50 hover:bg-indigo-700 transition-colors","aria-label":"Open Sidebar",initial:{x:"100%"},animate:{x:"0%"},exit:{x:"100%"},children:(0,S.jsx)(w.A,{})},"open-sidebar"),(B||[]).includes("VIEW_LEAVES_REPORTS")&&x&&(0,S.jsxs)(p.P.div,{className:"fixed inset-y-0 right-0 w-80 ".concat("dark"===t?"bg-gray-900":"bg-stone-100"," shadow-xl z-40 p-4 flex flex-col"),initial:{x:"100%"},animate:{x:"0%"},exit:{x:"100%"},children:[(0,S.jsxs)(p.P.h3,{className:"text-lg font-bold ".concat("dark"===t?"text-gray-200 hover:bg-gray-500":"text-gray-900 hover:bg-blue-100"," cursor-pointer mb-1 mt-20  p-2 rounded-md"),onClick:()=>{k(!0),m(!1)},whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,S.jsx)(_.Qak,{className:"w-5 h-5 inline-block mr-2"}),"My Leaves"]}),(0,S.jsxs)(p.P.h3,{className:"text-lg font-bold ".concat("dark"===t?"text-gray-200 hover:bg-gray-500":"text-gray-900 hover:bg-blue-100"," cursor-pointer mb-4   p-2 rounded-md"),onClick:()=>{c("leaveReports"),m(!1)},whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,S.jsx)(_.Qak,{className:"w-5 h-5 inline-block mr-2"}),"Leaves Reports"]}),(0,S.jsxs)(p.P.h3,{className:"text-lg font-bold ".concat("dark"===t?"text-gray-200 hover:bg-gray-500":"text-gray-900 hover:bg-blue-100"," cursor-pointer mb-4   p-2 rounded-md"),onClick:()=>{c("leaves"),m(!1)},whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,S.jsx)(_.Qak,{className:"w-5 h-5 inline-block mr-2"}),"Total Employee Leaves"]}),(0,S.jsx)("button",{onClick:()=>m(!1),className:"absolute left-0 top-1/2 -translate-x-1/2 -translate-y-1/2 p-2 rounded-full bg-indigo-600 text-white shadow-lg hover:bg-indigo-700 transition-colors z-50","aria-label":"Close Sidebar",initial:{x:"100%"},animate:{x:"0%"},exit:{x:"100%"},children:(0,S.jsx)(N.A,{})})]},"sidebar")]}),(0,S.jsxs)("div",{className:"flex-1 transition-all duration-300 p-2 sm:p-3 lg:p-4",children:[x&&(0,S.jsx)("div",{className:"md:hidden fixed inset-0 bg-black opacity-50 z-30",onClick:()=>m(!1)}),(0,S.jsx)("main",{className:"p-2 sm:p-2 lg:p-2 ".concat(x&&D?"filter blur-sm":""),children:(0,S.jsxs)(y.N,{mode:"wait",children:["leaves"===i&&(0,S.jsx)(p.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:(0,S.jsx)(L.A,{onBack:()=>c(null)})},"leaves"),"leaveReports"===i&&(0,S.jsx)(p.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:(0,S.jsx)(j.A,{onBack:()=>c(null),leaveHistoryData:C,setLeaveHistoryData:R})},"reports"),null===i&&(0,S.jsxs)(p.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:[(0,S.jsx)("header",{className:"p-3 mb-6 text-left",children:(0,S.jsx)(F,{handleRequestLeave:()=>{Q(!0)}})}),(0,S.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(P,{title:"Casual Leave",leaveData:V,color:"#4CAF50"}),(0,S.jsx)(P,{title:"Paid Leave",leaveData:G,color:"#2196F3"}),(0,S.jsx)(P,{title:"Sick Leave",leaveData:Y,color:"#FFC107"}),(0,S.jsx)(P,{title:"Unpaid Leave",leaveData:X,color:"#EF5350"})]})}),(0,S.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[(0,S.jsx)(T,{}),(0,S.jsx)(q,{})]}),(0,S.jsx)(H,{leaveHistoryData:C}),W&&(0,S.jsx)(E,{onClose:()=>Q(!1),onAddLeave:e=>{const t="leaveHistory_".concat(o.employeeId),a=JSON.parse(localStorage.getItem(t))||[],s=[K(e),...a];localStorage.setItem(t,JSON.stringify(s)),R(s)}})]},"dashboard")]})})]})]})}}}]);
//# sourceMappingURL=733.4886b821.chunk.js.map