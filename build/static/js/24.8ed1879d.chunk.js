"use strict";(self.webpackChunktechlife=self.webpackChunktechlife||[]).push([[24],{1024:(e,t,s)=>{s.d(t,{A:()=>g});var a=s(9379),n=s(5043),r=s(9722),l=s(7234),d=s(579);const o=e=>{if(!e)return 0;const t=String(e).trim(),s=t.match(/PT(?:(\d+)H)?(?:(\d+)M)?/);if(s){return 60*(s[1]?parseInt(s[1],10):0)+(s[2]?parseInt(s[2],10):0)}if(!isNaN(Number(t)))return Math.round(60*Number(t));const a=t.match(/^(\d{1,2}):(\d{2})$/);return a?60*parseInt(a[1],10)+parseInt(a[2],10):0},i=e=>{const t=Math.floor(e/60),s=e%60;return"".concat(String(t).padStart(2,"0"),":").concat(String(s).padStart(2,"0"))},c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return null;const s=String(e).trim();try{let e,a=t||(new Date).toISOString().slice(0,10);if(/\d{4}-\d{2}-\d{2}T/.test(s)||s.includes("Z"))e=new Date(s);else if(/^\d{2}:\d{2}(:\d{2}(\.\d+)?)?$/.test(s)){let t=s.split(".")[0];e=new Date("".concat(a,"T").concat(t,"Z"))}else e=(/^\d{4}-\d{2}-\d{2}$/.test(s),new Date(s));return isNaN(e.getTime())?null:new Date(e.getTime()+198e5)}catch(a){return null}},x=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return"N/A";const s=String(e).trim();try{const e=c(s,t);return e?e.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0}):s}catch(a){return s}},m=e=>{const t=o(e||"");return t>0?i(t):"N/A"},g=e=>{let{onBack:t}=e;const[s,g]=(0,n.useState)("Recantly Added"),[p,u]=(0,n.useState)(""),{theme:h,userData:b}=(0,n.useContext)(l.ob),[y,f]=(0,n.useState)([]),[j,N]=(0,n.useState)(!1),[v,D]=(0,n.useState)(null),[w,k]=(0,n.useState)(1),[S,M]=(0,n.useState)(12);(0,n.useEffect)(()=>{let e=!1;return(async()=>{N(!0),D(null);try{var t,s,n;const l=(null===b||void 0===b?void 0:b.employeeId)||"ACS00000001",{startISO:d,endISO:g}=(()=>{const e=new Date;let t=e.getFullYear(),s=e.getMonth();if(p){const e=["January","February","March","April","May","June","July","August","September","October","November","December"].indexOf(p);-1!==e&&(s=e)}const a=new Date(t,s,1),n=new Date(t,s+1,0),r=e=>e.toISOString().slice(0,10);return{startISO:r(a),endISO:r(n)}})(),u={employeeId:l,startDate:d,endDate:g},h=await r.A.post("https://hrms.anasolconsultancyservices.com/api/attendance/graphql",{query:"\nquery getDetailsBetweenDates($employeeId: String!, $startDate: Date!, $endDate: Date!) {\n  getDetailsBetweenDates(employeeId: $employeeId, startDate: $startDate, endDate: $endDate) {\n    date\n    employeeId\n    isPresent\n    login\n    logout\n    effectiveHours\n    grossHours\n    mode\n  }\n}\n",variables:u},{headers:{"Content-Type":"application/json"}});if(e)return;if(null!==h&&void 0!==h&&null!==(t=h.data)&&void 0!==t&&t.errors&&h.data.errors.length)throw new Error(h.data.errors.map(e=>e.message).join("; "));const y=((null===h||void 0===h||null===(s=h.data)||void 0===s||null===(n=s.data)||void 0===n?void 0:n.getDetailsBetweenDates)||[]).map(e=>{const t=/^\d{4}-\d{2}-\d{2}$/.test(e.date)?e.date:(new Date).toISOString().slice(0,10),s=c(e.login,t),n=c(e.logout,t);let r=0;if(s&&n&&!isNaN(s.getTime())&&!isNaN(n.getTime()))r=Math.max(0,Math.floor((n-s)/6e4));else{const t=o(e.effectiveHours||""),s=o(e.grossHours||"");r=t||s||0}const l=o(e.effectiveHours||""),d=o(e.grossHours||"");return(0,a.A)((0,a.A)({},e),{},{date:e.date,loginDisplay:x(e.login,t),logoutDisplay:x(e.logout,t),effectiveHoursDisplay:m(e.effectiveHours),grossHoursDisplay:m(e.grossHours),totalDurationMinutes:r,totalDurationHHMM:r>0?i(r):"N/A",effectiveMinutes:l,grossMinutes:d,attended:(()=>{const t=e.isPresent;if(null==t)return!1;const s=String(t).toLowerCase();return["present","p","yes","true","1"].includes(s)})()})});f(y),k(1)}catch(l){console.error(l),D(l.message||"Failed to load attendance"),f([])}finally{e||N(!1)}})(),()=>{e=!0}},[p,b]);const I=(0,n.useMemo)(()=>{let e=[...y];switch(s){case"Ascending":e.sort((e,t)=>(e.employeeId||"").localeCompare(t.employeeId||""));break;case"Descending":e.sort((e,t)=>(t.employeeId||"").localeCompare(e.employeeId||""));break;default:e.sort((e,t)=>new Date(t.date)-new Date(e.date))}return e},[y,s]),A=Math.max(1,Math.ceil(I.length/S)),H=I.slice((w-1)*S,w*S),T=(0,n.useMemo)(()=>new Set(y.map(e=>e.employeeId)).size,[y]);(0,n.useMemo)(()=>{const e=I.reduce((e,t)=>e+(t.totalDurationMinutes||0),0),t=I.reduce((e,t)=>e+(t.grossMinutes||0),0);return{totalDurationMinutes:e,totalDurationHHMM:e>0?i(e):"00:00",totalGrossMinutes:t,totalGrossHHMM:t>0?i(t):"00:00"}},[I]);return(0,d.jsxs)("div",{className:"p-4 sm:p-8 ".concat("dark"===h?"bg-gray-400":"bg-gray-50"," min-h-screen"),children:["\xa0 \xa0 \xa0 ",(0,d.jsxs)("h1",{className:"text-3xl font-extrabold text-indigo-800 mb-6 border-b pb-2",children:["\xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("span",{role:"img","aria-label":"clock",children:"\u23f0"})," Employee Attendance Tracker \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 ",(0,d.jsx)("button",{onClick:t,className:"mb-4 px-4 py-2 bg-indigo-100 text-blue-600 rounded-lg font-semibold shadow hover:bg-indigo-200 transition",children:"\u2190 Back to Dashboard"}),"\xa0 \xa0 \xa0 ",(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 p-4 ".concat("dark"===h?"bg-gray-700":"bg-white"," rounded-xl shadow-lg border-l-4 border-indigo-500"),children:["\xa0 \xa0 \xa0 \xa0 ",(0,d.jsxs)("div",{className:"text-lg font-semibold ".concat("dark"===h?"text-gray-100":"text-gray-700"," mb-4 sm:mb-0"),children:["\xa0 \xa0 \xa0 \xa0 \xa0 Total Employees: ",(0,d.jsx)("span",{className:"text-indigo-600 text-2xl",children:T}),"\xa0 \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 \xa0 ",(0,d.jsxs)("div",{className:"flex flex-wrap gap-4",children:["\xa0 \xa0 \xa0 \xa0 \xa0 ","\xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsxs)("select",{value:p,onChange:e=>u(e.target.value),className:"p-2 border border-gray-300 rounded-lg text-sm ".concat("dark"===h?"bg-gray-700 text-gray-50":"bg-white"),children:["\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("option",{value:"",children:"Select Month: All"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",["January","February","March","April","May","June","July","August","September","October","November","December"].map(e=>(0,d.jsx)("option",{value:e,children:e},e)),"\xa0 \xa0 \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsxs)("select",{value:s,onChange:e=>g(e.target.value),className:"p-2 border border-gray-300 rounded-lg text-sm ".concat("dark"===h?"bg-gray-700 text-gray-50":"bg-white"),children:["\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("option",{value:"Recantly Added",children:"Sorted By: Recently Added"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("option",{value:"Ascending",children:"EmployeeId: Ascending"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("option",{value:"Descending",children:"EmployeeId: Descending"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("option",{value:"This Month",children:"Date: This Month"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("option",{value:"Last Month",children:"Date: Last Month"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("option",{value:"Last 7 days",children:"Date: Last 7 days"}),"\xa0 \xa0 \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsxs)("select",{value:S,onChange:e=>{M(Number(e.target.value)),k(1)},className:"p-2 border border-gray-300 rounded-lg text-sm bg-white",children:["\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("option",{value:6,children:"6 / page"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("option",{value:12,children:"12 / page"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("option",{value:24,children:"24 / page"}),"\xa0 \xa0 \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 ",(0,d.jsxs)("div",{className:"overflow-x-auto shadow-2xl rounded-xl",children:["\xa0 \xa0 \xa0 \xa0 ",(0,d.jsxs)("table",{className:"min-w-full bg-white border-collapse",children:["\xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsxs)("thead",{className:"bg-indigo-600 text-white sticky top-0",children:["\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsxs)("tr",{children:["\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("th",{className:"py-3 px-4 text-left text-sm font-semibold uppercase tracking-wider border-b border-indigo-500 hidden sm:table-cell",children:"EmployeeId"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("th",{className:"py-3 px-4 text-left text-sm font-semibold uppercase tracking-wider border-b border-indigo-500 hidden sm:table-cell",children:"Date"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("th",{className:"py-3 px-4 text-left text-sm font-semibold uppercase tracking-wider border-b border-indigo-500 hidden sm:table-cell",children:"Mode"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("th",{className:"py-3 px-4 text-left text-sm font-semibold uppercase tracking-wider border-b border-indigo-500 hidden sm:table-cell",children:"Login (IST)"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("th",{className:"py-3 px-4 text-left text-sm font-semibold uppercase tracking-wider border-b border-indigo-500 hidden sm:table-cell",children:"Logout (IST)"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("th",{className:"py-3 px-4 text-left text-sm font-semibold uppercase tracking-wider border-b border-indigo-500 hidden sm:table-cell",children:"Total Duration"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("th",{className:"py-3 px-4 text-left text-sm font-semibold uppercase tracking-wider border-b border-indigo-500 hidden sm:table-cell",children:"Effective Hours"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("th",{className:"py-3 px-4 text-left text-sm font-semibold uppercase tracking-wider border-indigo-500 hidden sm:table-cell",children:"Status"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("th",{className:"py-3 px-4 text-left text-sm font-semibold uppercase tracking-wider border-indigo-500 sm:hidden",children:"Employee Details"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsxs)("tbody",{children:["\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",j?(0,d.jsx)("tr",{children:(0,d.jsx)("td",{colSpan:10,className:"text-center py-8",children:"Loading\u2026"})}):v?(0,d.jsx)("tr",{children:(0,d.jsx)("td",{colSpan:10,className:"text-center py-8 text-red-600",children:v})}):0===H.length?(0,d.jsx)("tr",{children:(0,d.jsx)("td",{colSpan:10,className:"text-center py-6 text-gray-500",children:"No attendance records found for the selected filters."})}):H.map(e=>{const t=e.totalDurationHHMM||"N/A",s=e.effectiveHoursDisplay||"N/A",a=e.attended?"bg-green-100 text-green-800":"bg-red-100 text-red-800";return(0,d.jsxs)("tr",{className:"border-b transition-colors duration-200 ".concat("dark"===h?"bg-gray-700 hover:bg-gray-600":"hover:bg-gray-200"),children:["\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("td",{className:"py-4 px-4 ".concat("dark"===h?" text-gray-50":"text-gray-700"," font-medium hidden sm:table-cell"),children:e.employeeId}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("td",{className:"py-4 px-4 text-sm ".concat("dark"===h?" text-gray-50":"text-gray-700"," hidden sm:table-cell"),children:e.date}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsxs)("td",{className:"py-4 px-4 text-sm text-gray-600 hidden sm:table-cell",children:["\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("span",{className:"px-3 py-1 text-xs font-semibold rounded-full ".concat("Office"===e.mode?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"),children:e.mode}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ","\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("td",{className:"py-4 px-4 text-sm ".concat("dark"===h?" text-gray-50":"text-gray-700"," hidden sm:table-cell"),children:e.loginDisplay}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("td",{className:"py-4 px-4 text-sm ".concat("dark"===h?" text-gray-50":"text-gray-700"," hidden sm:table-cell"),children:e.logoutDisplay}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("td",{className:"py-4 px-4 text-sm font-semibold ".concat("dark"===h?" text-indigo-500":"text-indigo-700"," hidden sm:table-cell"),children:t}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("td",{className:"py-4 px-4 text-sm font-bold ".concat("dark"===h?" text-green-300":"text-green-700"," hidden sm:table-cell"),children:s}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsxs)("td",{className:"py-4 px-4 text-sm hidden sm:table-cell",children:["\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("span",{className:"px-3 py-1 text-xs font-semibold rounded-full ".concat(a),children:e.attended?"Present":"Absent"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsxs)("td",{className:"py-4 px-4 sm:hidden",children:["\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsxs)("div",{className:"flex flex-col space-y-1",children:["\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("span",{className:"text-base font-bold ".concat("dark"===h?" text-indigo-300":"text-indigo-700"),children:e.employeeId}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsxs)("span",{className:"text-sm ".concat("dark"===h?" text-gray-100":"text-gray-600"),children:["Date: ",e.date," (",e.mode,")"]}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ","\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsxs)("span",{className:"text-sm ".concat("dark"===h?" text-gray-100":"text-gray-600"),children:[e.loginDisplay," - ",e.logoutDisplay]}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("div",{className:"text-xs font-medium mt-1",children:(0,d.jsxs)("span",{className:"".concat("dark"===h?" text-green-400":"text-green-700"),children:["Effective: ",s]})}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("div",{className:"text-xs font-medium mt-1",children:(0,d.jsxs)("span",{className:"".concat("dark"===h?" text-indigo-300":"text-indigo-700"),children:["Total: ",t]})}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 "]},"".concat(e.employeeId,"-").concat(e.date))}),"\xa0 \xa0 \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 ","\xa0 \xa0 \xa0 ",(0,d.jsxs)("div",{className:"flex items-center justify-between mt-4",children:["\xa0 \xa0 \xa0 \xa0 ",(0,d.jsxs)("div",{className:"text-sm text-gray-600",children:["Showing ",H.length," of ",I.length," records"]}),"\xa0 \xa0 \xa0 \xa0 ",(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:["\xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("button",{onClick:()=>k(e=>Math.max(1,e-1)),disabled:w<=1,className:"px-3 py-1 bg-gray-200 rounded disabled:opacity-50",children:"Prev"}),"\xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsxs)("span",{className:"px-3 py-1",children:["Page ",w," / ",A]}),"\xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("button",{onClick:()=>k(e=>Math.min(A,e+1)),disabled:w>=A,className:"px-3 py-1 bg-gray-200 rounded disabled:opacity-50",children:"Next"}),"\xa0 \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 ",(0,d.jsxs)("p",{className:"text-sm ".concat("dark"===h?" text-gray-50":"text-gray-700"," mt-6 text-center"),children:["\xa0 \xa0 \xa0 \xa0 Data is displayed for ",(0,d.jsx)("strong",{children:I.length})," attendance record(s) based on current filters. \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 "]})}}}]);
//# sourceMappingURL=24.8ed1879d.chunk.js.map