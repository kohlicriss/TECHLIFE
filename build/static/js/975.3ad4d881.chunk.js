"use strict";(self.webpackChunktechlife=self.webpackChunktechlife||[]).push([[975],{9975:(e,t,a)=>{a.r(t),a.d(t,{default:()=>T});var r=a(5043),s=a(3895),l=a(9657),i=(a(2157),a(379)),n=a(9002),o=a(7869),d=a(2647),c=a(6102),x=a(6028),m=a(2185),g=a(760),u=a(2291),p=a(6992),y=a(3546),h=a(5440),b=(a(7249),a(6213)),f=a(3721),v=a(9910),w=a(7158),j=a(9463),k=a(8326),N=a(2538),S=a(184),D=a(8877),C=a(2397),_=a(4921),L=a(579);const A=e=>{let{onClose:t,onAddLeave:a}=e;const{userData:s,theme:l}=(0,r.useContext)(v.ob),[i,n]=(0,r.useState)(""),[o,d]=(0,r.useState)(""),[c,x]=(0,r.useState)(""),[m,g]=(0,r.useState)(""),[u,p]=(0,r.useState)(!1),[y,f]=(0,r.useState)((null===s||void 0===s?void 0:s.employeeId)||""),w=()=>{if(!i||!o)return 0;const e=new Date(i),t=new Date(o);return Math.floor((t-e)/864e5)+1};return(0,L.jsx)(h.P.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-opacity-25 backdrop-blur-sm p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:(0,L.jsx)(h.P.div,{className:"relative w-full max-w-3xl mx-auto  my-auto max-h-[90vh] overflow-y-auto transform transition-all duration-300 scale-95 md:scale-100",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{duration:.3},children:(0,L.jsxs)("form",{onSubmit:async e=>{console.log("Submitting leave request:",{fromDate:i,toDate:o,leaveType:c,reason:m,isHalfDay:u});const r={employeeId:null===s||void 0===s?void 0:s.employeeId,numberOfDays:w(),req_To_from:i,req_To_to:o,leave_Reason:m,isHalf_Day:u,leave_Type:c};try{await b.A.post(`https://hrms.anasolconsultancyservices.com/api/attendance/employee/leaveRequest/${null===s||void 0===s?void 0:s.employeeId}`,r),console.log("Leave request submitted:",r);const e=`leaveHistory_${null===s||void 0===s?void 0:s.employeeId}`,l=JSON.parse(localStorage.getItem(e))||[];localStorage.setItem(e,JSON.stringify([r,...l])),a&&a(r),t()}catch(l){console.log(r)}},className:"relative w-full max-w-3xl mx-auto rounded-lg   shadow-2xl my-auto max-h-[90vh] overflow-y-auto transform transition-all duration-300 scale-95 md:scale-100 border border-green-200 "+("dark"===l?"bg-gray-700 text-white":"bg-white text-gray-800"),children:[(0,L.jsx)("div",{className:" mb-4 text-center rounded-t bg-gradient-to-br from-orange-200 to-orange-600",children:(0,L.jsx)("h2",{className:"text-2xl pt-6  font-bold border-b pb-8 "+("dark"===l?"text-white border-gray-100":"text-gray-800 border-gray-200"),children:"     Request a Leave"})}),(0,L.jsxs)("div",{className:"space-y-4 p-4",children:[(0,L.jsxs)(h.P.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.1},children:[(0,L.jsx)("label",{className:"block text-sm font-medium  "+("dark"===l?"text-white":"text-gray-700"),children:"Employee Id"}),(0,L.jsx)("input",{type:"text",value:y,onChange:e=>f(e.target.value),className:"w-full px-3 mt-2 sm:px-4 md:px-5 py-3 sm:py-4 border-2 rounded-lg sm:rounded-xl transition-all duration-300 text-sm\n                                                focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 focus:outline-none "+("dark"===l?"border border-gray-100 text-white ":"border border-gray-300 text-black")})]}),(0,L.jsxs)("div",{children:[(0,L.jsx)("label",{className:"block text-sm font-medium  "+("dark"===l?"text-white":"text-gray-700"),children:"From Date"}),(0,L.jsx)("input",{type:"date",value:i,onChange:e=>n(e.target.value),className:"w-full px-3 mt-2 sm:px-4 md:px-5 py-3 sm:py-4 border-2 rounded-lg sm:rounded-xl transition-all duration-300 text-sm\n                                                focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 focus:outline-none "+("dark"===l?"border border-gray-100 text-white":"border border-gray-300 text-black"),required:!0})]}),(0,L.jsxs)("div",{children:[(0,L.jsx)("label",{className:"block text-sm font-medium  "+("dark"===l?"text-white":"text-gray-700"),children:"To Date"}),(0,L.jsx)("input",{type:"date",value:o,onChange:e=>d(e.target.value),className:"w-full px-3 mt-2 sm:px-4 md:px-5 py-3 sm:py-4 border-2 rounded-lg sm:rounded-xl transition-all duration-300 text-sm\n                                               focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 focus:outline-none "+("dark"===l?"border border-gray-100 text-white":"border border-gray-300 text-black"),required:!0})]}),(0,L.jsxs)("div",{children:[(0,L.jsx)("label",{className:"block text-sm font-medium  "+("dark"===l?"text-white":"text-gray-700"),children:"Leave Type"}),(0,L.jsxs)("select",{value:c,onChange:e=>x(e.target.value),className:`w-full px-3 mt-2 sm:px-4 md:px-5 py-3 sm:py-4 border-2 rounded-lg sm:rounded-xl transition-all duration-300 text-sm\n                                                focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 focus:outline-none ${"dark"===l?"border border-gray-100  ":"border border-gray-300 "} shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-200 focus:ring-opacity-50`,required:!0,children:[(0,L.jsx)("option",{value:"",className:""+("dark"===l?"bg-gray-700 text-white":"bg-white text-gray-800"),children:"Select"}),(0,L.jsx)("option",{value:"Sick",className:""+("dark"===l?"bg-gray-700 text-white":"bg-white text-gray-800"),children:"Sick"}),(0,L.jsx)("option",{value:"Casual",className:""+("dark"===l?"bg-gray-700 text-white":"bg-white text-gray-800"),children:"Casual"}),(0,L.jsx)("option",{value:"Unpaid",className:""+("dark"===l?"bg-gray-700 text-white":"bg-white text-gray-800"),children:"Unpaid"}),(0,L.jsx)("option",{value:"Paid",className:""+("dark"===l?"bg-gray-700 text-white":"bg-white text-gray-800"),children:"Paid"})]})]}),(0,L.jsxs)("div",{children:[(0,L.jsx)("label",{className:"block text-sm font-medium  "+("dark"===l?"text-white":"text-gray-700"),children:"Reason"}),(0,L.jsx)("textarea",{value:m,onChange:e=>g(e.target.value),className:"w-full px-3 mt-2 sm:px-4 md:px-5 py-3 sm:py-4 border-2 rounded-lg sm:rounded-xl transition-all duration-300 text-sm\n                                                focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 focus:outline-none "+("dark"===l?"border border-gray-100 text-white ":"border border-gray-300 text-black"),required:!0})]}),(0,L.jsx)("div",{children:(0,L.jsxs)("label",{children:[(0,L.jsx)("input",{type:"checkbox",checked:u,onChange:e=>p(e.target.checked)}),"Half Day"]})}),(0,L.jsxs)("div",{className:"mt-6 flex justify-end space-x-3 border-t p-4",children:[(0,L.jsx)("button",{type:"submit",className:"rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},children:"Submit"}),(0,L.jsx)("button",{type:"button",onClick:t,className:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},children:"Cancel"})]})]})]})})})},$=e=>{let{title:t,leaveData:a={type:t,consumed:0,remaining:0,total:0},color:d}=e;(0,s.A)("(max-width:500px)");const{type:x,consumed:m,remaining:g,total:u}=a,y=[{name:"Consumed",value:m},{name:"Remaining",value:Math.max(u-m,0)}],b=["#8884d8","#82ca9d","#ffc658","#ff8042","#a4de6c"],{theme:f}=(0,r.useContext)(v.ob);return(0,L.jsxs)(h.P.div,{className:"rounded-xl shadow-lg p-6 h-full flex flex-col items-center justify-center border border-gray-200 hover:border-indigo-500 hover:shadow-2xl transition-all duration-300 ease-in-out "+("dark"===f?"bg-gray-600":"bg-stone-100 text-gray-800"),initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:[(0,L.jsx)("h1",{className:"text-xl font-bold mb-4 text-center "+("dark"===f?"bg-gradient-to-br from-yellow-100 to-yellow-400 bg-clip-text text-transparent border-gray-100":"text-gray-700"),children:t}),(0,L.jsx)(l.A,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",className:"w-full",children:(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(n.u,{width:140,height:140,children:(0,L.jsxs)(p.r,{children:[(0,L.jsx)(c.F,{data:y,cx:"50%",cy:"50%",innerRadius:30,outerRadius:60,paddingAngle:3,dataKey:"value",stroke:"none",className:"ml-0",children:y.map((e,t)=>(0,L.jsx)(o.f,{fill:b[t]},`cell-${t}`))}),(0,L.jsx)("text",{x:"50%",y:"50%",textAnchor:"middle",dominantBaseline:"middle",className:"text-lg font-semibold "+("dark"===f?"text-gray-200":"text-gray-700"),children:x.split(" ")[0]}),(0,L.jsx)(i.m,{})]})}),(0,L.jsxs)("div",{className:"text-center mt-4 space-y-2 text-sm "+("dark"===f?"text-white":"text-gray-700"),children:[(0,L.jsxs)("div",{children:[(0,L.jsx)("strong",{children:"Consumed:"})," ",(0,L.jsx)("span",{className:"font-semibold text-sm text-red-600",children:m})," ","days"]}),(0,L.jsxs)("div",{children:[(0,L.jsx)("strong",{children:"Available:"})," ",(0,L.jsxs)("span",{className:"font-semibold text-sm text-green-600",children:[" ",g]})," ","days"]}),(0,L.jsxs)("div",{children:[(0,L.jsx)("strong",{children:"Total:"})," ",u," days"]})]})]})})]})},I=()=>{const e=["#8884d8","#82ca9d","#ffc658","#ff8042","#a4de6c"],{empID:t}=(0,f.g)(),{userData:a,theme:x}=(0,r.useContext)(v.ob),[m,g]=(0,r.useState)([]),[u,y]=(0,r.useState)(!0);(0,r.useEffect)(()=>{const e=`https://hrms.anasolconsultancyservices.com/api/attendance/employee/${null===a||void 0===a?void 0:a.employeeId}/personalLeavesData`;C.HN.get(e).then(e=>{const t=e.data.map(e=>({name:e.leaveType,value:e.days}));g(t)}).catch(e=>{console.error("Error fetching personal leave data:",e)}).finally(()=>{y(!1)})},[t]);const b=(0,s.A)("(max-width:768px)"),w=m.filter(e=>e.value>0);return(0,L.jsxs)(h.P.div,{className:" rounded-xl shadow-lg p-6 h-full flex flex-col border border-gray-200 hover:border-indigo-500 hover:shadow-2xl transition-all duration-300 ease-in-out "+("dark"===x?"bg-gray-600":"bg-stone-100 text-gray-800"),initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[(0,L.jsx)("h1",{className:`text-2xl font-bold mb-4 text-center ${"dark"===x?"bg-gradient-to-br from-purple-100 to-purple-400 bg-clip-text text-transparent border-gray-100":"text-gray-700 border-gray-200"} border-b pb-4`,children:"Leave Type Breakdown"}),(0,L.jsx)(l.A,{display:"flex",flexDirection:b?"column":"row",justifyContent:"center",alignItems:"center",height:"100%",gap:2,p:1,children:u?(0,L.jsx)("div",{className:"text-gray-500 text-center w-full",children:"Loading..."}):w.length>0?(0,L.jsx)(n.u,{width:"100%",height:250,children:(0,L.jsxs)(p.r,{children:[(0,L.jsx)(c.F,{data:w,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,fill:"#8884d8",dataKey:"value",paddingAngle:2,labelLine:!1,label:e=>{let{name:t,percent:a}=e;return`${t} ${(100*a).toFixed(0)}%`},children:w.map((t,a)=>(0,L.jsx)(o.f,{fill:e[a%e.length]},`cell-${a}`))}),(0,L.jsx)(d.J,{content:()=>(0,L.jsx)("text",{x:"50%",y:"50%",textAnchor:"middle",dominantBaseline:"middle",className:"text-base font-semibold text-gray-700",children:"Leave Types"}),position:"center"}),(0,L.jsx)(i.m,{})]})}):(0,L.jsx)("div",{className:` text-center w-full ${"dark"===x?"text-white":"text-gray-500"} italic`,children:"No leave data available."})})]})},R=()=>{const{employeeId:e}=(0,f.g)(),{userData:t,theme:a}=(0,r.useContext)(v.ob),[o,d]=(0,r.useState)("All"),[c,p]=(0,r.useState)([]),[y,b]=(0,r.useState)(!0),[w,j]=(0,r.useState)(null),k="dark"===a?"#FFFFFF":"#000000";(0,r.useEffect)(()=>{const e=`https://hrms.anasolconsultancyservices.com/api/attendance/employee/${null===t||void 0===t?void 0:t.employeeId}/leavesbar-graph`;return C.HN.get(e).then(e=>{const t=e.data.map(e=>({Day:e.day,Rate:e.rate}));p(t),console.log("Give me Weekly pattern:",t)}).catch(e=>{console.error("Error fetching leaves bar chart data:",e);const t=e.response?`Error: ${e.response.status} - ${e.response.statusText}`:"Failed to load weekly leave pattern data.";j(t)}).finally(()=>{b(!1)}),()=>{}},[e]);const N=(0,s.A)("(max-width:768px)"),S=["All",...new Set(c.map(e=>e.Day))],D="All"===o?c:c.filter(e=>e.Day===o);return(0,L.jsxs)(h.P.div,{className:" shadow-lg rounded-xl p-6 h-full flex flex-col border border-gray-200 hover:border-indigo-500 hover:shadow-2xl transition-all duration-300 ease-in-out "+("dark"===a?"bg-gray-600":"bg-stone-100 text-gray-800"),initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:[(0,L.jsx)("h1",{className:`text-2xl font-bold mb-4 text-center ${"dark"===a?"bg-gradient-to-br from-purple-100 to-purple-400 bg-clip-text text-transparent border-gray-100":"text-gray-700 border-gray-200"} border-b pb-4`,children:"Weekly Leave Pattern"}),(0,L.jsxs)("div",{className:"mb-4 text-center",children:[(0,L.jsx)("label",{className:"mr-2 font-semibold  "+("dark"===a?"text-white":"text-gray-700"),children:"Select Day:"}),(0,L.jsx)("select",{value:o,onChange:e=>d(e.target.value),className:"p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500 "+("dark"===a?"text-white":" text-gray-800 "),disabled:y||w,children:S.map(e=>(0,L.jsx)("option",{value:e,children:e},e))})]}),(0,L.jsx)(l.A,{display:"flex",flexDirection:N?"column":"row",justifyContent:"center",alignItems:"center",height:"100%",gap:5,p:N?1:2,children:D.length>0?(0,L.jsx)(n.u,{width:"100%",height:230,children:(0,L.jsxs)(u.E,{data:D,margin:{top:10,right:10,left:10,bottom:0},children:[(0,L.jsx)(m.W,{dataKey:"Day",axisLine:!1,tickLine:!1,stroke:k,className:"text-sm text-gray-600"}),(0,L.jsx)(g.h,{hide:!0}),(0,L.jsx)(i.m,{contentStyle:{backgroundColor:"dark"===a?"#63676cff":"#fff",border:a?"1px solid #4B5563":"1px solid #ccc"}}),(0,L.jsx)(x.y,{dataKey:"Rate",fill:"#69d6dbff",radius:[8,8,0,0]})]})}):(0,L.jsx)("div",{className:` text-center w-full ${"dark"===a?"text-white":"text-gray-500"} italic`,children:"No weekly leave pattern data available."})})]})},P=e=>{let{leaveHistoryData:t}=e;const[a,s]=(0,r.useState)(1),[l,i]=(0,r.useState)("All"),[n,o]=(0,r.useState)("All"),[d,c]=(0,r.useState)("Recently added"),[x,m]=(0,r.useState)(10),[g,u]=(0,r.useState)(!1),{empID:p}=(0,f.g)(),[y,h]=(0,r.useState)(null),{theme:b}=(0,r.useContext)(v.ob),w=["All",...new Set(t.map(e=>e.leave_type))],j=["All",...new Set(t.map(e=>e.status))],k=()=>{h(null)},D=(()=>{let e=[...t];switch(e=e.filter(e=>("All"===l||e.leave_type===l)&&("All"===n||e.status===n)),d){case"Ascending":e.sort((e,t)=>e.leave_type.localeCompare(t.leave_type));break;case"Descending":e.sort((e,t)=>t.leave_type.localeCompare(e.leave_type));break;case"Last Month":const t=new Date;t.setMonth(t.getMonth()-1),e=e.filter(e=>new Date(e.leave_On)>=t);break;case"Last 7 Days":const a=new Date;a.setDate(a.getDate()-7),e=e.filter(e=>new Date(e.leave_On)>=a);break;default:e.sort((e,t)=>new Date(t.action_Date)-new Date(e.action_Date))}return e})(),C=Math.ceil(D.length/x),_=D.slice((a-1)*x,a*x);return(0,L.jsxs)("div",{className:"shadow-lg rounded-xl p-6 border "+("dark"===b?"bg-gray-600":"bg-white"),children:[(0,L.jsx)("h2",{className:`text-2xl font-bold mb-4 text-left border-b pb-4 ${"dark"===b?"bg-gradient-to-br from-green-400 to-green-800 bg-clip-text text-transparent border-gray-100":"text-gray-800 border-gray-200"} `,children:"Leave Requests History"}),(0,L.jsxs)("div",{className:"flex flex-wrap items-center gap-4 mb-6",children:[(0,L.jsxs)("div",{className:"relative",children:[(0,L.jsx)("label",{className:"text-base font-semibold mr-2 "+("dark"===b?"text-white":"text-gray-700"),children:"Leave Type:"}),(0,L.jsx)("select",{value:l,onChange:e=>i(e.target.value),className:"px-3 py-1.5 rounded-md focus:ring-indigo-500 focus:border-indigo-500 text-gray-700 border "+("dark"===b?"border-black  bg-gray-500 text-white":"border-gray-300"),children:w.map(e=>(0,L.jsx)("option",{value:e,children:e},e))})]}),(0,L.jsxs)("div",{children:[(0,L.jsx)("label",{className:"text-base font-semibold mr-2 "+("dark"===b?"text-white":"text-gray-700"),children:"Status:"}),(0,L.jsx)("select",{value:n,onChange:e=>o(e.target.value),className:"px-3 py-1.5 rounded-md focus:ring-indigo-500 focus:border-indigo-500 text-gray-700 border "+("dark"===b?"border-black bg-gray-500 text-white":"border-gray-300"),children:j.map(e=>(0,L.jsx)("option",{value:e,children:e},e))})]}),(0,L.jsxs)("div",{className:"relative",children:[(0,L.jsx)("label",{className:"text-base font-semibold mr-2 "+("dark"===b?"text-white":"text-gray-700"),children:"Sort by:"}),(0,L.jsx)("select",{value:d,onChange:e=>c(e.target.value),className:`px-3 py-1.5 rounded-md focus:ring-indigo-500 focus:border-indigo-500 text-gray-700 ${"dark"===b?"border-black  bg-gray-500 text-white":"border-gray-300"} border`,children:["Recently added","Ascending","Descending","Last Month","Last 7 Days"].map(e=>(0,L.jsx)("option",{value:e,children:e},e))})]})]}),(0,L.jsx)("div",{className:"overflow-x-auto rounded-xl",children:(0,L.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 broder border-gray-200",children:[(0,L.jsx)("thead",{className:"bg-gray-50 "+("dark"===b?"border-black  bg-gray-500 text-white":""),children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider "+("dark"===b?"text-white":""),children:"Status"}),(0,L.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider "+("dark"===b?"text-white":""),children:"Details"}),(0,L.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider "+("dark"===b?"text-white":""),children:"Action"}),(0,L.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider "+("dark"===b?"text-white":""),children:"Leave Type"}),(0,L.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider "+("dark"===b?"text-white":""),children:"Leave On"}),(0,L.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider "+("dark"===b?"text-white":""),children:"Request By"}),(0,L.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider "+("dark"===b?"text-white":""),children:"Action Date"}),(0,L.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider "+("dark"===b?"text-white":""),children:"Rejection Reason"}),(0,L.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider "+("dark"===b?"text-white":""),children:"LeaveDetails"})]})}),(0,L.jsx)("tbody",{className:"bg-white divide-y divide-gray-500",children:_.length>0?_.map((e,t)=>(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm  "+("dark"===b?" bg-gray-500 text-gray-200":"text-gray-900"),children:(0,L.jsxs)("span",{className:"px-2 py-1 rounded-full text-white text-xs font-semibold "+("APPROVED"===e.status?"bg-green-500":"rejected"===e.status?"bg-red-500":"bg-blue-500"),children:[" ",e.status]})}),(0,L.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm  "+("dark"===b?" bg-gray-500 text-gray-200":"text-gray-900"),children:e.details}),(0,L.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm  "+("dark"===b?" bg-gray-500 text-gray-200":"text-gray-900"),children:e.action}),(0,L.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm  "+("dark"===b?" bg-gray-500 text-gray-200":"text-gray-900"),children:e.leave_type}),(0,L.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm  "+("dark"===b?" bg-gray-500 text-gray-200":"text-gray-900"),children:e.leave_on}),(0,L.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm  "+("dark"===b?" bg-gray-500 text-gray-200":"text-gray-900"),children:e.request_By}),(0,L.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm  "+("dark"===b?" bg-gray-500 text-gray-200":"text-gray-900"),children:e.action_Date}),(0,L.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm  "+("dark"===b?" bg-gray-500 text-gray-200":"text-gray-900"),children:e.rejection_Reason}),(0,L.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-center "+("dark"===b?"bg-gray-500 text-gray-200 ":""),children:(0,L.jsx)("button",{onClick:()=>{h(e)},className:"text-indigo-600 hover:text-indigo-800 text-lg",title:"View Details",children:(0,L.jsx)(S.t69,{className:` ${"dark"===b?"text-blue-200":"text-blue-600"} text-lg inline w-6 h-6 md:w-6 md:h-6 transition `})})}),(0,L.jsx)(N.A,{leave:y,onClose:k})]},t)):(0,L.jsx)("tr",{children:(0,L.jsx)("td",{colSpan:8,className:`text-center py-4 text-gray-500 ${"dark"===b?" bg-gray-500 text-white":""} italic`,children:"No leave history found."})})})]})}),(0,L.jsxs)("div",{className:"mt-4 flex flex-col sm:flex-row items-center justify-between",children:[(0,L.jsxs)("div",{className:"flex items-center gap-2 mb-4 sm:mb-0",children:[(0,L.jsx)("span",{className:"text-sm text-gray-700 "+("dark"===b?"text-white":"text-gray-700"),children:"Rows per page:"}),(0,L.jsx)("select",{value:x,onChange:e=>{m(Number(e.target.value)),s(1)},className:"border border-gray-300 px-2 py-1 rounded-md text-sm "+("dark"===b?"bg-gray-600 text-white border-gray-500":"bg-white text-gray-800"),children:[10,25,50,100].map(e=>(0,L.jsx)("option",{value:e,children:e},e))})]}),(0,L.jsxs)("nav",{className:"flex items-center gap-2",children:[(0,L.jsx)("button",{onClick:()=>s(e=>Math.max(e-1,1)),disabled:1===a,className:`px-4 py-2 text-sm font-medium  border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed ${"dark"===b?"bg-gray-600 text-white border-gray-500 hover:bg-gray-500":"bg-white text-gray-800"} `,children:"Previous"}),(0,L.jsxs)("span",{className:"text-sm text-gray-700 "+("dark"===b?"text-white":"text-gray-700"),children:["Page ",a," of ",C]}),(0,L.jsx)("button",{onClick:()=>s(e=>Math.min(e+1,C)),disabled:a===C||0===C,className:`px-4 py-2 text-sm font-medium  border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed ${"dark"===b?"bg-gray-600 text-white border-gray-500 hover:bg-gray-500":"bg-white text-gray-800"} `,children:"Next"})]})]})]})},E=e=>{let{handleRequestLeave:t}=e;const{userData:a,theme:s}=(0,r.useContext)(v.ob),[l,i]=(0,r.useState)({image:null,initials:" "}),[n,o]=(0,r.useState)(null),[d,c]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("emppayload")),t=localStorage.getItem("loggedInUserImage"),a=((null===e||void 0===e?void 0:e.displayName)||" ").split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase();i({image:t,initials:a})},[a]),(0,r.useEffect)(()=>{null!==a&&void 0!==a&&a.employeeId&&async function(){c(!0);try{const e=(new Date).getMonth()+1,t=(new Date).getFullYear(),r=`https://hrms.anasolconsultancyservices.com/api/attendance/getLeaves/${null===a||void 0===a?void 0:a.employeeId}/${e}/${t}?employee_id=${null===a||void 0===a?void 0:a.employeeId}&month=${e}&year=${t}`,s=await b.A.get(r);o(s.data)}catch(e){o(null)}finally{c(!1)}}()},[null===a||void 0===a?void 0:a.employeeId]),(0,L.jsxs)(h.P.div,{className:"flex flex-col xl:flex-row justify-between items-start xl:items-center p-3 sm:p-4 rounded-2xl shadow-2xl mb-8 transition-all duration-300\n                        "+("dark"===s?"bg-gray-800 border-t-4 border-indigo-600":"bg-white border-t-4 border-indigo-600"),initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6,type:"spring",stiffness:100},children:[(0,L.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-4 sm:space-y-0 sm:space-x-6 w-full xl:w-3/5 mb-6 xl:mb-0",children:[(0,L.jsx)(h.P.div,{className:`flex-shrink-0 w-16 h-16 sm:w-20 sm:h-20 rounded-full overflow-hidden flex items-center justify-center border-4 \n                        ${"dark"===s?"border-gray-700 bg-indigo-700":"border-indigo-100 bg-indigo-600"} shadow-xl`,whileHover:{scale:1.05},transition:{type:"spring",stiffness:300},children:l.image?(0,L.jsx)("img",{src:l.image,alt:"Profile",className:"w-full h-full object-cover"}):(0,L.jsx)("span",{className:"text-2xl sm:text-3xl font-extrabold text-white",children:l.initials})}),(0,L.jsxs)("div",{className:"flex-1",children:[(0,L.jsxs)("h2",{className:"text-2xl sm:text-4xl font-extrabold flex items-center "+("dark"===s?"text-white":"text-gray-800"),children:["Welcome, ",(0,L.jsx)("span",{className:"text-indigo-600 ml-2",children:(null===a||void 0===a?void 0:a.fullName)||"User"}),"!"]}),(0,L.jsx)("p",{className:"text-sm sm:text-base mt-1 "+("dark"===s?"text-gray-400":"text-gray-500"),children:"Your monthly attendance summary for a quick glance."}),(0,L.jsx)("div",{className:`mt-4 p-4 rounded-xl transition-colors duration-300 \n                        ${"dark"===s?"bg-gray-900/50 backdrop-blur-sm":"bg-indigo-50/70"} border ${"dark"===s?"border-gray-700":"border-indigo-200"}`,children:d?(0,L.jsx)("span",{className:"text-xs font-medium text-indigo-400",children:"Fetching attendance summary..."}):n?(0,L.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-y-3 gap-x-6 text-sm",children:[["Paid","Sick","Casual","Unpaid"].map((e,t)=>(0,L.jsxs)("div",{className:"flex flex-col",children:[(0,L.jsx)("span",{className:"text-xs uppercase font-medium "+("dark"===s?"text-gray-400":"text-gray-600"),children:e}),(0,L.jsx)("span",{className:"text-xl font-bold "+("dark"===s?"text-indigo-400":"text-indigo-600"),children:n[e.toLowerCase()]})]},e)),(0,L.jsxs)("div",{className:"col-span-2 md:col-span-1 flex flex-col items-start md:items-center p-2 rounded-lg bg-white shadow-inner md:bg-transparent md:shadow-none",children:[(0,L.jsx)("span",{className:"text-xs uppercase font-medium "+("dark"===s?"text-gray-400":"text-gray-600"),children:"Shift"}),(0,L.jsx)("span",{className:"text-sm font-semibold mt-1 "+("dark"===s?"text-white":"text-gray-800"),children:n.shiftName||"N/A"})]})]}):(0,L.jsx)("span",{className:"text-sm font-medium text-red-500",children:"Could not load attendance summary."})})]})]}),(0,L.jsxs)(h.P.button,{onClick:t,className:"w-full xl:w-auto flex items-center justify-center px-6 py-3 mt-4 xl:mt-0 bg-gradient-to-r from-indigo-500 to-purple-600 text-base text-white font-bold rounded-xl shadow-lg hover:from-indigo-600 hover:to-purple-700 focus:outline-none focus:ring-4 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-white transition-all duration-300 transform active:scale-98",whileHover:{scale:1.05,boxShadow:"0 10px 20px -5px rgba(99, 102, 241, 0.7)"},whileTap:{scale:.98},children:[(0,L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 inline mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,L.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),"Request New Leave"]})]})},T=()=>{var e;const{theme:t}=(0,r.useContext)(v.ob),[a,s]=(0,r.useState)([]),{empID:l,employeeId:i}=(0,f.g)(),{userData:n}=(0,r.useContext)(v.ob),[o,d]=(0,r.useState)(null),c=((null===n||void 0===n||null===(e=n.roles)||void 0===e?void 0:e[0])||"").toUpperCase(),[x,m]=(0,r.useState)(!1),[g,u]=(0,r.useState)(!1),[p,N]=(0,r.useState)(!1),[S,T]=(0,r.useState)(!0),[H,q]=(0,r.useState)(null),F=["TEAM_LEAD","HR","MANAGER","ADMIN"].includes(c),[O,M]=(0,r.useState)([]),[B,U]=(0,r.useState)([]),[J,z]=(0,r.useState)(null),W=null!==n&&void 0!==n&&n.roles[0]?`ROLE_${null===n||void 0===n?void 0:n.roles[0]}`:null;(0,r.useEffect)(()=>{(async()=>{let e=await C.ZQ.get(`role-access/${W}`);console.log("from Employee :",e.data),U(e.data)})()},[]),(0,r.useEffect)(()=>{B&&z(null===B||void 0===B?void 0:B.permissions)},[B]),console.log(J);const[K,Q]=(0,r.useState)([]);function V(e){return{status:e.status||"pending",details:e.details||"-",action:e.action||"-",leave_type:e.leave_type||e.leave_Type||"-",leave_on:e.leave_on||e.req_To_from||"-",request_By:e.request_By||e.Request_By||"-",action_Date:e.action_Date||e.Action_Date||"-",rejection_Reason:e.rejection_Reason||e.Rejection_Reason||"-"}}(0,r.useEffect)(()=>{Q(null===n||void 0===n?void 0:n.permissions)},[n]),console.log("permissions from userdata:",K),(0,r.useEffect)(()=>{(async()=>{if(null!==n&&void 0!==n&&n.employeeId)try{const e=await C.HN.get(`https://hrms.anasolconsultancyservices.com/api/attendance/employee/${null===n||void 0===n?void 0:n.employeeId}/leaves?page=0&size=10`),t=Array.isArray(e.data)?e.data:[],a=`leaveHistory_${n.employeeId}`,r=JSON.parse(localStorage.getItem(a))||[],s=t.map(V),l=function(e){const t=new Set;return e.filter(e=>{const a=`${e.leave_type}-${e.leave_on}-${e.status}`;return!t.has(a)&&(t.add(a),!0)})}([...r.map(V),...s]);M(l)}catch(H){console.error("Failed to fetch leave history:",H),M([])}})()},[null===n||void 0===n?void 0:n.employeeId]);(0,r.useEffect)(()=>{if(null!==n&&void 0!==n&&n.employeeId){const e=localStorage.getItem(`leaveHistory_${n.employeeId}`);M(e?JSON.parse(e):[])}},[null===n||void 0===n?void 0:n.employeeId]),(0,r.useEffect)(()=>{const e=b.A.CancelToken.source();return(async()=>{try{const t=await C.HN.get(`https://hrms.anasolconsultancyservices.com/api/attendance/employee/${null===n||void 0===n?void 0:n.employeeId}/leave-summary`,{cancelToken:e.token}),a={Casual:"Casual Leave",Paid:"Paid Leave",Unpaid:"Unpaid Leave",Sick:"Sick Leave"},r=t.data.map(e=>({type:a[e.type]||e.type,consumed:e.consumed,remaining:e.remaining,total:e.total}));s(r)}catch(H){b.A.isCancel(H)?console.log("Request cancelled",H.message):console.error("Error fetching line chart data:",H)}})(),()=>{e.cancel("Operation canceled by the user.")}},[i]);const[G,Y]=(0,r.useState)(!1),Z=a.find(e=>"Casual Leave"===e.type),X=a.find(e=>"Paid Leave"===e.type),ee=a.find(e=>"Sick Leave"===e.type),te=a.find(e=>"Unpaid Leave"===e.type);return(0,L.jsxs)("div",{className:"min-h-screen p-2 sm:p-3 lg:p-4 font-sans "+("dark"===t?"bg-gray-900 text-white":"bg-gray-100 text-gray-900"),children:[(0,L.jsxs)(y.N,{children:[F&&!x&&(0,L.jsx)(h.P.button,{onClick:()=>m(!0),className:"fixed right-0 top-1/2 transform -translate-y-1/2 bg-indigo-600 text-white p-2 rounded-l-lg shadow-lg z-50 hover:bg-indigo-700 transition-colors","aria-label":"Open Sidebar",initial:{x:"100%"},animate:{x:"0%"},exit:{x:"100%"},transition:{duration:.3,delay:.2},children:(0,L.jsx)(j.A,{})},"open-sidebar"),(J||[]).includes("VIEW_LEAVES_REPORTS")&&x&&(0,L.jsxs)(h.P.div,{className:`fixed inset-y-0 right-0 w-80 ${"dark"===t?"bg-gray-900":"bg-stone-100"} shadow-xl z-40 p-4 flex flex-col`,initial:{x:"100%"},animate:{x:"0%"},exit:{x:"100%"},transition:{duration:.3},children:[(0,L.jsxs)(h.P.h3,{className:`text-lg font-bold ${"dark"===t?"text-gray-200 hover:bg-gray-500":"text-gray-900 hover:bg-blue-100"} cursor-pointer mb-1 mt-20  p-2 rounded-md`,onClick:()=>{N(!0),m(!1)},whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,L.jsx)(D.Qak,{className:"w-5 h-5 inline-block mr-2"}),"My Leaves"]}),(0,L.jsxs)(h.P.h3,{className:`text-lg font-bold ${"dark"===t?"text-gray-200 hover:bg-gray-500":"text-gray-900 hover:bg-blue-100"} cursor-pointer mb-4   p-2 rounded-md`,onClick:()=>{d("leaveReports"),m(!1)},whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,L.jsx)(D.Qak,{className:"w-5 h-5 inline-block mr-2"}),"Leaves Reports"]}),(0,L.jsxs)(h.P.h3,{className:`text-lg font-bold ${"dark"===t?"text-gray-200 hover:bg-gray-500":"text-gray-900 hover:bg-blue-100"} cursor-pointer mb-4   p-2 rounded-md`,onClick:()=>{d("leaves"),m(!1)},whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,L.jsx)(D.Qak,{className:"w-5 h-5 inline-block mr-2"}),"Total Employee Leaves"]}),(0,L.jsx)("button",{onClick:()=>m(!1),className:"absolute left-0 top-1/2 -translate-x-1/2 -translate-y-1/2 p-2 rounded-full bg-indigo-600 text-white shadow-lg hover:bg-indigo-700 transition-colors z-50","aria-label":"Close Sidebar",initial:{x:"100%"},animate:{x:"0%"},exit:{x:"100%"},transition:{duration:.3,delay:.2},children:(0,L.jsx)(k.A,{})})]},"sidebar")]}),(0,L.jsxs)("div",{className:"flex-1 transition-all duration-300 p-2 sm:p-3 lg:p-4",children:[x&&(0,L.jsx)("div",{className:"md:hidden fixed inset-0 bg-black opacity-50 z-30",onClick:()=>m(!1)}),(0,L.jsx)("main",{className:"p-2 sm:p-2 lg:p-2 "+(x&&F?"filter blur-sm":""),children:(0,L.jsxs)(y.N,{mode:"wait",children:["leaves"===o&&(0,L.jsx)(h.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:(0,L.jsx)(_.A,{onBack:()=>d(null)})},"leaves"),"leaveReports"===o&&(0,L.jsx)(h.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:(0,L.jsx)(w.A,{onBack:()=>d(null),leaveHistoryData:O,setLeaveHistoryData:M})},"reports"),null===o&&(0,L.jsxs)(h.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:[(0,L.jsx)("header",{className:"p-3 mb-6 text-left",children:(0,L.jsx)(E,{handleRequestLeave:()=>{Y(!0)}})}),(0,L.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)($,{title:"Casual Leave",leaveData:Z,color:"#4CAF50"}),(0,L.jsx)($,{title:"Paid Leave",leaveData:X,color:"#2196F3"}),(0,L.jsx)($,{title:"Sick Leave",leaveData:ee,color:"#FFC107"}),(0,L.jsx)($,{title:"Unpaid Leave",leaveData:te,color:"#EF5350"})]})}),(0,L.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[(0,L.jsx)(I,{}),(0,L.jsx)(R,{})]}),(0,L.jsx)(P,{leaveHistoryData:O}),G&&(0,L.jsx)(A,{onClose:()=>Y(!1),onAddLeave:e=>{const t=`leaveHistory_${n.employeeId}`,a=JSON.parse(localStorage.getItem(t))||[],r=[V(e),...a];localStorage.setItem(t,JSON.stringify(r)),M(r)}})]},"dashboard")]})})]})]})}}}]);
//# sourceMappingURL=975.3ad4d881.chunk.js.map