"use strict";(self.webpackChunktechlife=self.webpackChunktechlife||[]).push([[137],{2397:(e,a,r)=>{r.d(a,{Pt:()=>c,bI:()=>d,qB:()=>h,vx:()=>m,yE:()=>i});var s=r(6213);let t=!1,l=[];const o=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;l.forEach(r=>{e?r.reject(e):r.resolve(a)}),l=[]},n=e=>{const a=s.A.create({baseURL:e});return a.interceptors.request.use(e=>{const a=localStorage.getItem("accessToken");return a&&(e.headers.Authorization=`Bearer ${a}`),e},e=>Promise.reject(e)),a.interceptors.response.use(e=>e,async r=>{var d;const i=r.config;if(401===(null===(d=r.response)||void 0===d?void 0:d.status)&&!i._retry){if(t)return new Promise((e,a)=>{l.push({resolve:e,reject:a})}).then(e=>(i.headers.Authorization=`Bearer ${e}`,a(i))).catch(e=>Promise.reject(e));i._retry=!0,t=!0;const r=localStorage.getItem("accessToken");console.log(`\ud83d\udd34 Token expired for ${e}. Old Token:`,r);try{const a=await s.A.post("http://hrms.anasolconsultancyservices.com/api/auth/refresh-token",{},{withCredentials:!0}),{accessToken:r}=a.data;localStorage.setItem("accessToken",r),console.log(`\ud83d\udfe2 New Token for ${e}:`,r),i.data instanceof FormData&&(i.data=function(e){const a=new FormData;for(let[r,s]of e.entries())a.append(r,s);return a}(i.data)),o(null,r);const t=n(e);return i.headers.Authorization=`Bearer ${r}`,t(i)}catch(c){return console.error("Refresh token failed. Logging out.",c),localStorage.clear(),window.location.href="/login",o(c),Promise.reject(c)}finally{t=!1}}return Promise.reject(r)}),a};window.addEventListener("storage",e=>{"accessToken"===e.key&&console.log("\ud83d\udd04 Token updated in another tab:",e.newValue)});const d=n("http://hrms.anasolconsultancyservices.com/api"),i=n("http://hrms.anasolconsultancyservices.com/api"),c=n("http://hrms.anasolconsultancyservices.com/api"),m=n("http://hrms.anasolconsultancyservices.com/api/notification"),h=n("http://localhost:8088/api/ticket")},9137:(e,a,r)=>{r.r(a),r.d(a,{default:()=>h});var s=r(5043),t=r(2397),l=r(184),o=r(5394),n=r(9910),d=r(3679),i=r(579);const c=()=>(0,i.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,i.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-blue-500"})}),m=e=>{let{message:a}=e;return(0,i.jsxs)("div",{className:"text-center p-8 bg-red-100 text-red-700 rounded-lg",children:[(0,i.jsx)("h3",{className:"font-bold text-lg",children:"Oops! Something went wrong."}),(0,i.jsx)("p",{children:a})]})},h=()=>{const[e,a]=(0,s.useState)([]),[r,h]=(0,s.useState)(!0),[u,x]=(0,s.useState)(null),[g,b]=(0,s.useState)(!1),[p,f]=(0,s.useState)([]),[y,v]=(0,s.useState)(new Set),[j,w]=(0,s.useState)(""),[N,k]=(0,s.useState)(null),[C,S]=(0,s.useState)([]),[T,I]=(0,s.useState)(!1),[L,A]=(0,s.useState)({}),{userData:E,theme:F}=(0,s.useContext)(n.o),P=(null===E||void 0===E?void 0:E.roles)||[],M=P.includes("ADMIN")||P.includes("HR"),$=async()=>{try{h(!0);const e=null===E||void 0===E?void 0:E.employeeId;if(!e)return void x("Employee ID not found. Please login again.");const r=await t.yE.get(`employee/team/${e}`),s=Array.isArray(r.data)?r.data:[r.data];a(s||[]),x(null)}catch(e){console.error("Error fetching teams:",e),x("Could not fetch teams data.")}finally{h(!1)}};(0,s.useEffect)(()=>{$(),M&&(async()=>{try{const e=(await t.yE.get("employee/0/1000/employeeId/asc/employees")).data.map(e=>({value:e.employeeId,label:`${e.displayName} (${e.employeeId})`}));f(e)}catch(e){console.error("Error fetching employees:",e)}})()},[M]);const z=async e=>{if(e.preventDefault(),!(()=>{const e={};return j.trim()||(e.teamName="Team Name is required."),N||(e.teamLead="Team Lead is required."),0===C.length&&(e.teamMembers="At least one Team Member is required."),A(e),0===Object.keys(e).length})())return;I(!0),A({});const a={teamName:j,teamLeadId:N.value,employeeIds:C.map(e=>e.value)};try{await t.yE.post("employee/team",a),await $(),b(!1),w(""),k(null),S([]),alert("Team created successfully!")}catch(r){console.error("Error creating team:",r),A({general:"Failed to create team. Please check the data and try again."})}finally{I(!1)}},D=(e,a,r)=>{const s=L[a];return(0,i.jsxs)("div",{className:"group relative",children:[(0,i.jsxs)("label",{className:"block text-sm font-semibold mb-3 flex items-center "+("dark"===F?"text-gray-200":"text-gray-800"),children:[e,(0,i.jsx)("span",{className:"text-red-500 ml-1 text-base",children:"*"})]}),r,s&&(0,i.jsxs)("div",{className:"mt-2 flex items-center space-x-2 text-red-600",children:[(0,i.jsx)(o.tr_,{className:"w-4 h-4 flex-shrink-0"}),(0,i.jsx)("p",{className:"text-sm font-medium",children:s})]})]},a)},R={control:(e,a)=>({...e,padding:"0.6rem 0.5rem",border:"2px solid "+(a.isFocused?"#3b82f6":L[a.selectProps.name]?"#f87171":"dark"===F?"#4b5563":"#e5e7eb"),backgroundColor:"dark"===F?"#374151":"#ffffff",borderRadius:"0.75rem",boxShadow:a.isFocused?"0 0 0 4px rgba(59, 130, 246, 0.2)":"none","&:hover":{borderColor:a.isFocused?"#3b82f6":"dark"===F?"#6b7280":"#d1d5db"}}),multiValue:e=>({...e,backgroundColor:"dark"===F?"#4f46e5":"#e0e7ff",color:"dark"===F?"white":"#3730a3",borderRadius:"0.5rem"}),multiValueLabel:e=>({...e,color:"dark"===F?"white":"#3730a3"}),multiValueRemove:e=>({...e,color:"dark"===F?"#e0e7ff":"#4f46e5",":hover":{backgroundColor:"dark"===F?"#6366f1":"#c7d2fe",color:"white"}}),option:(e,a)=>{let{isFocused:r,isSelected:s}=a;return{...e,backgroundColor:s?"dark"===F?"#4f46e5":"#6366f1":r?"dark"===F?"#374151":"#f3f4f6":"dark"===F?"#1f2937":"white",color:s?"white":"dark"===F?"#d1d5db":"#1f2937"}},menu:e=>({...e,backgroundColor:"dark"===F?"#1f2937":"white",borderRadius:"0.75rem"}),singleValue:e=>({...e,color:"dark"===F?"white":"black"})};return(0,i.jsxs)("div",{className:"p-6 md:p-8 min-h-screen "+("dark"===F?"bg-gray-900":"bg-gray-50"),children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,i.jsxs)("h1",{className:"text-3xl font-bold flex items-center "+("dark"===F?"text-white":"text-gray-800"),children:[(0,i.jsx)(l.YXz,{className:"mr-3 text-blue-500"})," All Teams"]}),M&&(0,i.jsxs)("button",{onClick:()=>b(!0),className:"bg-black text-white px-5 py-2 rounded-lg font-semibold hover:bg-gray-800 transition-colors flex items-center shadow-md",children:[(0,i.jsx)(l.OiG,{className:"mr-2"})," Create Team"]})]}),r?(0,i.jsx)(c,{}):u?(0,i.jsx)(m,{message:u}):(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map((e,a)=>{var r,s,t;const o=e.teamId||a,n=(e=>y.has(e))(o),d=n?e.employees:null===(r=e.employees)||void 0===r?void 0:r.slice(0,5),c=(null===(s=e.employees)||void 0===s?void 0:s.length)>5;return(0,i.jsxs)("div",{className:"rounded-lg shadow-lg overflow-hidden border transition-shadow duration-300 "+("dark"===F?"bg-gray-800 border-gray-700 hover:shadow-blue-500/20":"bg-white border-gray-200 hover:shadow-xl"),children:[(0,i.jsxs)("div",{className:"p-5",children:[(0,i.jsx)("h2",{className:"text-xl font-bold truncate "+("dark"===F?"text-white":"text-gray-900"),children:e.teamName}),e.teamLead&&(0,i.jsxs)("div",{className:"flex items-center text-md mt-2 "+("dark"===F?"text-gray-300":"text-gray-600"),children:[(0,i.jsx)(l.e7y,{className:"mr-2 text-green-500"}),(0,i.jsx)("strong",{children:"Lead:"}),(0,i.jsx)("span",{className:"ml-1",children:e.teamLead})]})]}),(0,i.jsxs)("div",{className:"px-5 py-4 border-t "+("dark"===F?"bg-gray-800/50 border-gray-700":"bg-gray-50 border-gray-200"),children:[(0,i.jsxs)("h3",{className:"font-semibold mb-2 "+("dark"===F?"text-gray-300":"text-gray-700"),children:["Members (",(null===(t=e.employees)||void 0===t?void 0:t.length)||0,")"]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"flex flex-wrap gap-2",children:null===d||void 0===d?void 0:d.map(e=>(0,i.jsx)("span",{className:"text-xs font-semibold px-2.5 py-1 rounded-full "+("dark"===F?"bg-blue-900 text-blue-300":"bg-blue-100 text-blue-800"),children:e.displayName},e.employeeId))}),c&&(0,i.jsx)("button",{onClick:()=>(e=>{const a=new Set(y);a.has(e)?a.delete(e):a.add(e),v(a)})(o),className:"flex items-center space-x-1 text-sm text-blue-600 hover:text-blue-800 font-medium transition-colors",children:n?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{children:"Show Less"}),(0,i.jsx)(l.Ucs,{className:"w-3 h-3"})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("span",{children:["+",e.employees.length-5," more"]}),(0,i.jsx)(l.Vr3,{className:"w-3 h-3"})]})})]})]})]},o)})}),g?(0,i.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-md flex items-center justify-center z-[200] p-4",children:(0,i.jsxs)("div",{className:"rounded-3xl w-full max-w-2xl max-h-[95vh] overflow-hidden shadow-2xl flex flex-col "+("dark"===F?"bg-gray-800":"bg-white"),children:[(0,i.jsx)("div",{className:"px-8 py-6 bg-gradient-to-r from-blue-500 to-indigo-700 text-white relative",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsx)("div",{className:"p-3 bg-white/20 rounded-xl",children:(0,i.jsx)(l.YXz,{className:"w-8 h-8"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-2xl font-bold",children:"Create New Team"}),(0,i.jsx)("p",{className:"text-white/90 text-sm",children:"Organize employees into a new team."})]})]}),(0,i.jsx)("button",{onClick:()=>b(!1),className:"p-3 hover:bg-white/20 rounded-full transition-all group",children:(0,i.jsx)(l.QCr,{className:"w-6 h-6 group-hover:rotate-90 transition-transform"})})]})}),(0,i.jsx)("div",{className:"overflow-y-auto flex-grow",children:(0,i.jsxs)("form",{className:"p-8",onSubmit:z,children:[(0,i.jsxs)("div",{className:"space-y-6",children:[D("Team Name","teamName",(0,i.jsx)("input",{type:"text",value:j,onChange:e=>w(e.target.value),className:"w-full px-5 py-4 border-2 rounded-xl transition-all duration-300\n                                        focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 focus:outline-none\n                                        "+(L.teamName?"border-red-300 bg-red-50 focus:border-red-500 focus:ring-red-500/20":"dark"===F?"border-gray-600 bg-gray-700 text-white hover:border-gray-500":"border-gray-200 bg-white hover:border-gray-300"),placeholder:"e.g., Development Team"})),D("Team Lead","teamLead",(0,i.jsx)(d.Ay,{name:"teamLead",options:p,value:N,onChange:k,isClearable:!0,styles:R})),D("Team Members","teamMembers",(0,i.jsx)(d.Ay,{name:"teamMembers",isMulti:!0,options:p,value:C,onChange:S,styles:R}))]}),L.general&&(0,i.jsx)("div",{className:"mt-6 p-4 border-l-4 border-red-400 rounded-r-lg "+("dark"===F?"bg-red-900/20":"bg-red-50"),children:(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(o.tr_,{className:"w-5 h-5 text-red-400 mr-3"}),(0,i.jsx)("p",{className:"font-medium "+("dark"===F?"text-red-300":"text-red-800"),children:L.general})]})})]})}),(0,i.jsxs)("div",{className:"px-8 py-6 border-t flex justify-end space-x-4 "+("dark"===F?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"),children:[(0,i.jsx)("button",{type:"button",onClick:()=>b(!1),className:"px-8 py-3 border-2 rounded-xl font-semibold transition-all "+("dark"===F?"border-gray-600 text-gray-300 hover:bg-gray-600":"border-gray-300 text-gray-700 hover:bg-gray-100"),children:"Cancel"}),(0,i.jsx)("button",{type:"button",onClick:z,disabled:T,className:"px-10 py-3 bg-gradient-to-r from-blue-600 to-indigo-700 text-white font-bold rounded-xl\n                                     hover:shadow-lg transform hover:scale-105 transition-all flex items-center space-x-2\n                                     "+(T?"cursor-not-allowed opacity-75":""),children:T?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"h-5 w-5 border-4 border-white border-t-transparent rounded-full animate-spin"}),(0,i.jsx)("span",{children:"Creating..."})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.G3G,{className:"w-5 h-5"}),(0,i.jsx)("span",{children:"Create Team"})]})})]})]})}):null]})}}}]);
//# sourceMappingURL=137.3f4ccfbc.chunk.js.map